\documentclass[preprint,compress,3p,10pt,fleqn]{elsarticle}
%\usepackage{lineno,hyperref}
%\modulolinenumbers[5]
\usepackage{amscd}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{subfigure}
\usepackage{color}
\usepackage{mathrsfs}
\usepackage{epsfig}
\usepackage{booktabs}
\usepackage{float}
%% cross reference jump
\usepackage{hyperref}
\hypersetup{
colorlinks=true,
linkcolor=black
}
\numberwithin{equation}{section}
%\numberwithin{table}{section}
%\numberwithin{figure}{section}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{remark}[theorem]{Remark}
% \newtheorem{lemma}{Lemma}[section]
% \newtheorem{remark}{Remark}[section]
\newtheorem{expl}{Example}[section]
\newenvironment{example}{\begin{expl}\rm}{\end{expl}}

\def\proof{\par{\it Proof}. \ignorespaces}
\def\endproof{\vbox{\hrule height0.6pt\hbox{%
\vrule height1.3ex width0.6pt\hskip0.8ex \vrule width0.6pt} \hrule
height0.6pt } \bigskip}

\renewcommand{\figurename}{Fig.}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% personal add %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
%% \usepackage{lineno}

\journal{submitted to Elsevier}

\begin{document}
\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for theassociated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for theassociated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for theassociated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \affiliation{organization={},
%%             addressline={},
%%             city={},
%%             postcode={},
%%             state={},
%%             country={}}
%% \fntext[label3]{}

% \title{Hamiltonian structure and structure-preserving methods for the two-dimensional fractional nonlinear Schr{\"o}dinger wave equations}
\title{Hamiltonian-preserving schemes for the two-dimensional fractional nonlinear Schr{\"o}dinger wave equations}
%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{}
%% \affiliation[label1]{organization={},
%%             addressline={},
%%             city={},
%%             postcode={},
%%             state={},
%%             country={}}
%%
%% \affiliation[label2]{organization={},
%%             addressline={},
%%             city={},
%%             postcode={},
%%             state={},
%%             country={}}

\author[myaddress]{Yang Liu}
\ead{liuyang@stu.sicnu.edu.cn}

\author[myaddress,mysecondaddress]{Maohua Ran\corref{mycorrespondingauthor}}
\cortext[mycorrespondingauthor]{Corresponding author.}
\ead{maohuaran@163.com}


\author[myaddress]{Li Zhang}
%\ead{turingscat@126.com}

\address[myaddress]{School of Mathematical Sciences and V.C. and V.R. Key Lab, Sichuan Normal University, Chengdu 610068, China}

\address[mysecondaddress]{School of Mathematics, Aba Teachers University, Aba 623002, China}


\begin{abstract}
The focus of this paper is to construct structure-preserving numerical methods for the fractional nonlinear Schr{\"o}dinger wave equations in two dimensions. 
We first develop the Hamiltonian structure of the studied problem by virtue of the variational principle of the functional with fractional Laplacian. 
A fully-discrete numerical scheme is then proposed by applying the partitioned averaged vector field plus method and the Fourier pseudo-spectral method to the resulting Hamiltonian system. The obtained fully-discrete scheme is proved to be energy-preserving and mass-preserving in discrete sense. For comparison, more numerical methods are also listed. Finally, several numerical experiments are given to support our theoretical results.
\end{abstract}

%%Graphical abstract
% \begin{graphicalabstract}
% \includegraphics{grabs}
% \end{graphicalabstract}

%%Research highlights
%\begin{highlights}
%\item The two-dimensional fractional nonlinear Schr{\"o}dinger wave equations is studied.
%%The problem considered is based on the multi-dimensional fractional nonlinear Schr{\"o}dinger wave equations.
%\item The Hamiltonian structure of the studied problem is first developed.
%\item The proposed numerical method can preserve the original mass and original energy in discrete sense.
%\item Numerical results for one- and two- dimensional problems show the performance of the proposed method.
%\item Comparisons with existing methods are discussed and numerically verified. \end{highlights}

\begin{keyword}
%% keywords here, in the form: keyword \sep keyword
Structure-preserving method \sep
Fractional Schr{\"o}dinger wave equation \sep
Hamiltonian structure \sep
Averaged vector field method \sep
Fourier pseudo-spectral method
%% PACS codes here, in the form: \PACS code \sep code

%% MSC codes here, in the form: \MSC code \sep code
%% or \MSC[2008] code \sep code (2000 is the default)

\end{keyword}

\end{frontmatter}

%% \linenumbers

%% main text

\section{Introduction}\label{Section 1}
In this paper, we consider the following nonlinear fractional Schr{\"o}dinger wave equations (NFSWEs)
\begin{align}\label{eq_1}
u_{t t}+(-\Delta)^{\alpha / 2} u+\mathrm{i} \kappa u_{t}+\beta|u|^{2} u=0, \quad \boldsymbol{x} \in \Omega, t \in(0, T]
\end{align}
with the initial conditions
\begin{align}\label{eq_3}
u(\boldsymbol{x}, 0)=u_{0}(\boldsymbol{x}), \quad u_{t}(\boldsymbol{x}, 0)=u_{1}(\boldsymbol{x}),
\end{align}
and the boundary conditions with periods of $2L$,
where $\mathrm{i}=\sqrt{-1}, 1<\alpha \leq 2, \boldsymbol{x}\in \Omega \subset \mathbb{R}^d ( d=1,2), \kappa$ and $\beta>0$ are both real constants, $u(\boldsymbol{x}, t)$ is unknown complex valued function, $u_{0}(\boldsymbol{x})$ and $u_{1}(\boldsymbol{x})$ are known smooth functions. 

The fractional Laplacian can be given by the Fourier transform as

\begin{align}\label{eq_4}
	(-\Delta)^{\frac{\alpha}{2}} u(\boldsymbol{x},t)=\mathcal{F}^{-1}\left[|\boldsymbol{\xi}|^{\alpha} \mathcal{F}(u(\boldsymbol{\xi},t))\right],
	\end{align}
where $\mathcal{F}$ is the Fourier transform and $\mathcal{F}^{-1}$ denotes its inverse, see  \cite{caffarelliExtensionProblemRelated2007}.
In particular, the fractional Laplacian operator is equivalent to the Riesz fractional derivative in one dimension \cite{yangNumericalMethodsFractional2010,demengelFunctionalSpacesTheory2012}, and it will degenerate to the classical Laplacian operator when $\alpha=2$, and the corresponding integer order classical problem has been studied relatively well, see e.g., \cite{zhangConservativeNumericalScheme2003,baoUniformErrorEstimates2012,chengSeveralConservativeCompact2018,brugnanoClassEnergyconservingHamiltonian2018}.

%
%For the classical nonlinear Schr{\"o}dinger equation with wave operator,
%Bao and Cai  \cite{baoUniformErrorEstimates2012} established uniform error estimates of the conservative Crank-Nicolson method for the nonlinear Schr{\"o}dinger equation perturbed by the wave operator with a perturbation strength $\epsilon$.
%Cheng and Wu  \cite{chengSeveralConservativeCompact2018} described numerous conservative compact difference schemes.
%Brugnano et al. \cite{brugnanoClassEnergyconservingHamiltonian2018} proposed a scheme that conserves energy by employing the Hamiltonian boundary value methods and a Fourier expansion in space.
%Zhang and Chang  \cite{zhangConservativeNumericalScheme2003} developed a four-level finite difference scheme that conserves energy.
%Some structure-preserving difference schemes for the single and coupled fractional nonlinear Schr{\"o}dinger equation without wave operator has also been proposed, see \cite{wangSplitstepSpectralGalerkin2019,ranConservativeDifferenceScheme2016,wangLinearlyImplicitConservative2014,wangConservativeLinearizedDifference2015}.
%\begin{equation}
%(-\Delta)^{\frac{\alpha}{2}} u(x)=-\frac{\partial^{\alpha} u(x)}{\partial|x|^{\alpha}}=\frac{1}{2 \cos \left(\frac{\alpha \pi}{2}\right)}\left[{ }_{-\infty} L_{x}^{\alpha} u(x)+_{x} L_{+\infty}^{\alpha} u(x)\right]
%\label{eq_5}\end{equation}
%where ${ }_{-\infty} L_{x}^{\alpha} u(x)$ and ${ }_{x} L_{+\infty}^{\alpha} u(x)$ represent the left and right side Riemann-Liouville fractional derivatives, respectively \cite{demengelFunctionalSpacesTheory2012}.
%Specifically,
%%It is worth mentioning that
%the fractional Laplacian operator will degenerate to the classical Laplacian operator when $\alpha=2$, and the corresponding classical integer order problem has been studied relatively well.
%Consequently, Equation (\ref{eq_1}) become the classical nonlinear wave equation.

% \textcolor[rgb]{1.00,0.00,0.00}{From the definition of fractional Laplacian, we know that it is a self-adjoint and positive operator, then there exists a square root operator such that
% \begin{equation}
% 	\int_{\Omega}(-\Delta)^{\frac{\alpha}{2}} u(\boldsymbol{x}, t) \bar{v}(\boldsymbol{x}, t) d \boldsymbol{x}=\int_{\Omega}(-\Delta)^{\frac{\alpha}{4}} u(\boldsymbol{x}, t)(-\Delta)^{\frac{\alpha}{4}} \bar{v}(\boldsymbol{x}, t) d \boldsymbol{x},
% \label{eq_11223}
% \end{equation}
% with $(-\Delta)^{\frac{\alpha}{4}} u(\boldsymbol{x}, t)=\mathcal{F}^{-1}\left[|\boldsymbol{\sigma}|^{\frac{\alpha}{2}} \mathcal{F}(u(\boldsymbol{\sigma},t))\right].$}

The studied problem arises from a variety of physical applications, such as the nonrelativistic limit of the Klein-Gordon equation \cite{tsutsumiNonrelativisticApproximationNonlinear1984,machiharaNonrelativisticLimitEnergy2002}, the Langmuir wave envelope approximation in plasma \cite{colinSemidiscretizationTimeNonlinear1998}, and the modulated planar pulse approximation of the sine-Gordon equation for light bullets \cite{baoComparisonsSineGordonPerturbed2010,xinModelingLightBullets2000}. It can be regarded as a generalization of the integer order Schr{\"o}dinger equations, and can be derived by extending the Feynman path integral to the L$\acute{e}$vy one, see \cite{laskinFractionalQuantumMechanics2000,laskinFractionalSchrodingerEquation2002}.

Like many other differential models based on physical scenario, the studied problem \eqref{eq_1}-\eqref{eq_3} with periodic boundary conditions possesses the mass and energy conservation laws as follows
\begin{align}\label{eq_7}
G(t)=G(0), \quad E(t)=E(0), \quad 0 \leq t \leq T,
\end{align}
where the mass
\begin{align}\label{eq_8}
G(t)=\kappa\|u(\cdot, t)\|^{2}+2\operatorname{Im}\left(u_{t}, u\right),
\end{align}
and the energy
\begin{align}\label{eq_9}
E(t)=\frac{1}{2}\left(\left\|u_{t}(\cdot, t)\right\|^{2}+\left\|(-\Delta)^{\frac{\alpha}{4}} u(\cdot, t)\right\|^{2}+\frac{\beta}{2}\|u(\cdot, t)\|_{L^{4}}^{4}\right).
\end{align}
It can be obtained by taking inner product of \eqref{eq_1} with $u$ and $u_{t}$ respectively, and noticing that
 \begin{align} \label{eq_11223}
 	\int_{\Omega}(-\Delta)^{\frac{\alpha}{2}} u(\boldsymbol{x}, t) \bar{u}(\boldsymbol{x}, t) d \boldsymbol{x}=\int_{\Omega}(-\Delta)^{\frac{\alpha}{4}} u(\boldsymbol{x}, t)(-\Delta)^{\frac{\alpha}{4}} \bar{u}(\boldsymbol{x}, t) d \boldsymbol{x}.
 \end{align}

In view of this, we want to construct numerical methods that preserve these physical invariants. This is because the capacity to preserve some invariant properties of the original differential equation has become a criterion for evaluating the success of a numerical simulation in some fields, see \cite{liFiniteDifferenceCalculus1995}.
Also, Kang Feng said ``A basic idea behind the design of numerical schemes is that they can preserve the properties of the original problems as much as possible".
In fact, over the last 10 years, many researchers have paid attention to this topic. For example, Wang and Xiao \cite{wangCrankNicolsonDifference2013}
firstly presented a Crank-Nicolson difference scheme which conserves the discrete mass for the coupled nonlinear fractional Schr{\"o}dinger equations, and then,
in \cite{wangLinearlyImplicitConservative2014}, they further proposed a linearly implicit scheme which conserves a modified discrete mass and energy. Ran and Zhang \cite{ranConservativeDifferenceScheme2016} proposed an implicit difference scheme and linear difference scheme which preserves the original and modified mass and energy respectively for the strongly coupled nonlinear fractional Schr{\"o}dinger equations.
Wang and Huang \cite{wangEnergyConservativeDifference2015,wangConservativeLinearizedDifference2015} derived an energy and mass conservative Crank-Nicolson difference scheme and linear difference scheme for the single cubic fractional Schr{\"o}dinger equations.
Wang et al. \cite{wangSplitstepSpectralGalerkin2019} presented a split-step spectral Galerkin method for the two-dimensional nonlinear space-fractional
Schr{\"o}dinger equation, which only conserves the discrete mass.
In terms of the model problem \eqref{eq_1}-\eqref{eq_3}, Ran and Zhang \cite{ranLinearlyImplicitConservative2016} first developed a three-level linearly implicit difference scheme which preserves a modified discrete mass and energy well.
Li and Zhao  \cite{liFastEnergyConserving2018} considered a conservative strategy by combining the Crank-Nicolson method with the Galerkin finite element method, and a fast Krylov subspace solver with suitable circulant preconditioner is designed to save computational cost.
Cheng and Qin  \cite{chengConvergenceEnergyconservingScheme2022} developed a linearly-implicit conservative numerical scheme based on the scalar auxiliary variable (SAV) method, which only preserves a modified energy, not mass.
Hu et al. \cite{huEfficientEnergyPreserving2022} proposed three energy-preserving spectral Galerkin methods by applying Crank-Nicolson, SAV and exponential-SAV(ESAV) mthods in time respectively.
Zhang and Ran \cite{zhangHighorderStructurepreservingDifference2023} proposed and analyzed the higher order energy-preserving difference scheme based on triangular-SAV(T-SAV) approach.

However, existing work has focused almost exclusively on the one-dimensional case, and these proposed methods only preserve energy, or even modified energy. This leads us to develop more effective methods that can preserve the original energy and mass for solving multi-dimensional problems.
Noticing that the averaged vector field (AVF) method can preserve the energy for Hamiltonian systems \cite{buddGeometricIntegrationUsing1999,quispelNewClassEnergypreserving2008}. Moreover, the partitioned averaged vector field (PAVF) methods recently proposed that can preserve  more conservative property besides the conventional energy, and it has been used to construct conservative schemes for Hamiltonian ordinary differential equations, see \cite{caiPartitionedAveragedVector2018}. These research foundations make it possible for us to achieve our goals, and the derivation of the Hamiltonian structure for studied problem \eqref{eq_1}-\eqref{eq_3} is the successful key for construction of structure preserving methods.
%To our knowledge, structure-preserving algorithms for the two-dimensional fractional Schr{\"o}dinger equation have been considered infrequently.
%This is because the construction of a semi-discrete Hamiltonian system for a two-dimensional equation requires suitable spatial discretization, and the implementation of a two-dimensional nonlinear system is computationally complex and memory-intensive in practice.


%The goal of this paper is to develop a structure-preserving scheme for the two-dimensional NFSWEs that can preserve the original mass and energy exactly.
%Notice Cai et al.  \cite{caiPartitionedAveragedVector2018} developed partitioned averaged vector field (PAVF) methods that additional conservative property can be generated besides the conventional energy preservation for special problems, and have been used to construct conservative schemes for Hamiltonian ODEs.
%According to the theories of the structure-preserving algorithm, the derivation of the Hamiltonian formulation for the equation is the key process for constructing numerical schemes.

To our knowledge,  there is few work focusing on the Hamiltonian structure of fractional differential equations. Recently, Wang and Huang \cite{wangStructurepreservingNumericalMethods2018} presented the variational derivative of the functional with fractional Laplacian, and reformulated the one-dimensional fractional nonlinear Schr{\"o}dinger equation as a Hamiltonian system.
Fu and Cai  \cite{fuStructurepreservingAlgorithmsTwodimensional2020} derive the Hamiltonian formulation of the two-dimensional fractional Klein-Gordon-Schr{\"o}dinger equation, and subsequently developing conservative schemes.
Based on this, we first derive the Hamiltonian formulation of the two-dimensional NFSWEs \eqref{eq_1}-\eqref{eq_3} with periodic boundary conditions, and then successfully construct conservative schemes by combining the partitioned averaged vector field plus (PAVF-P) method and the Fourier pseudo-spectral method.
%This work contributes primarily in three ways:
%\begin{enumerate}[(1).]
%\item We derive the Hamiltonian formulation of the two-dimensional fractional nonlinear Schr{\"o}dinger equation with wave operator;
%\item We develop a conservative scheme for the equation based on the PAVF-P method and the Fourier pseudo-spectral method;
%\item We prove that the proposed scheme can preserve the original mass and energy exactly.
%\end{enumerate}
%Finally, numerical tests are undertaken to demonstrate the scheme's correctness and two conservation laws.

The remainder of this work is organized as follows.
In Section \ref{Section 2}, we first investigate the Hamiltonian structure of the two dimensional NFSWEs \eqref{eq_1}-\eqref{eq_3} with periodic boundary conditions, and then we derive a semi-discrete conservative system by using the Fourier pseudo-spectral method to approximate the resulting Hamiltonian system in space.
In Section \ref{Section 3}, we obtain a class of fully-discrete conservative schemes by utilizing the PAVF-P method to discrete the previous space semi-discrete system, and prove the discrete conservation laws. Numerical examples in one and two dimensions are presented in Section \ref{Section 4} to demonstrate the theoretical results. Section \ref{Section 5} presents some conclusions.


\section{Hamiltonian Structure and Space Semi-discrete System}\label{Section 2}
\subsection{Hamiltonian Structure of NFSWEs}
It is well-known that Hamiltonian structure is crucial in constructing structure-preserving algorithms for some problems.
However, to our knowledge, no researchers have considered the Hamiltonian structure of NFSWEs \eqref{eq_1}-\eqref{eq_3}.
Based on this, here we first reconstruct the Hamiltonian structure of such problem with periodic boundary conditions.

% \textcolor[rgb]{1.00,0.00,0.00}{
% In this section, We will derive an equivalent equation for system \eqref{eq_1}-\eqref{eq_3},
% and reformulate the equation as an infinite dimensional canonical Hamiltonian system by virtue of the variational derivative of the functional with fractional Laplacian.
% Then, we use the Fourier pseudo-spectral method to discrete the equation in space direction and obtain a semi-discrete conservative system,
% which can be reformulated a finite dimensional canonical Hamiltonian system.
% Following usual practice, we truncate \eqref{eq_1}-\eqref{eq_3} into a two dimensional finite computational domain $\Omega:=[-L, L] \times[-L, L]$ with period $2\boldsymbol{L}$.
% The fractional Laplacian, under the bounded interval $\Omega$ with the periodic boundary conditions, can be defined by Fourier series as \cite{zengErrorEstimateFourier2019}
% \begin{align}\label{eq_20}
% -(-\Delta)^{\frac{\alpha}{2}} u(\boldsymbol{x}, t)=-\sum_{k_{1} \in \mathbb{Z}} \sum_{k_{2} \in \mathbb{Z}}\left|v_{k_{1}}^{2}+v_{k_{2}}^{2}\right|^{\frac{\alpha}{2}} \hat{\mathbf{u}}_{\mathbf{k}} e^{\mathrm{i} \boldsymbol{v}_{\mathbf{k}} \cdot(\boldsymbol{x}+\boldsymbol{L})},
% \end{align}
% where $v_{k_{1}}=\frac{k_{1} \pi}{L}, v_{k_{2}}=\frac{k_{2} \pi}{L}, \boldsymbol{v}_{\mathbf{k}} \cdot(\boldsymbol{x}+\boldsymbol{L})=v_{k_{1}}(x+L)+v_{k_{2}}(y+L), \hat{\mathbf{u}}_{\mathbf{k}}$ is Fourier coefficient and is given by
% \begin{align}\label{eq_21}
% \hat{\mathbf{u}}_{\mathbf{k}}=\frac{1}{(2 L)^{2}} \int_{\Omega} u(\boldsymbol{x}, t) e^{-\mathrm{i} \boldsymbol{v}_{k} \cdot(\boldsymbol{x}+\boldsymbol{L})} d \boldsymbol{x}
% \end{align}
% In practical computation, the finite interval is always required, thus we will now only address the periodic boundary value problem, despite the fact that the following lemmas also hold true for the case on the whole line with minor modifications.}


% \begin{proof}
% 	From the Plancherel theorem, it follows that
% \begin{equation}
% \begin{aligned}
% \int_{\Omega}(-\Delta)^{\frac{\alpha}{2}} p q d \boldsymbol{x} &=(2 L)^{2} \sum_{l_{1} \in \mathbb{Z}} \sum_{l_{2} \in \mathbb{Z}}\left|v_{l_{1}}^{2}+v_{l_{2}}^{2}\right|^{\frac{\alpha}{2}} \hat{p}_{l_{1}, l_{2}} \hat{q}_{l_{1}, l_{2}} \\
% &=(2 L)^{2} \sum_{l_{1} \in \mathbb{Z}} \sum_{l_{2} \in \mathbb{Z}}\left|v_{l_{1}}^{2}+v_{l_{2}}^{2}\right|^{\frac{\alpha}{4}} \hat{p}_{l_{1}, l_{2}}\left|v_{l_{1}}^{2}+v_{l_{2}}^{2}\right|^{\frac{\alpha}{4}} \hat{q}_{l_{1}, l_{2}} \\
% &=(2 L)^{2} \sum_{l_{1} \in \mathbb{Z}} \sum_{l_{2} \in \mathbb{Z}} \hat{p}_{l_{1}, l_{2}}\left|v_{l_{1}}^{2}+v_{l_{2}}^{2}\right|^{\frac{\alpha}{2}} \hat{q}_{l_{1}, l_{2}} .
% \end{aligned}
% \label{eq_23}\end{equation}
% Then, we can deduce
% \begin{equation}
% \int_{\Omega}(-\Delta)^{\frac{\alpha}{2}} p q d \boldsymbol{x}=\int_{\Omega}(-\Delta)^{\frac{\alpha}{4}} p(-\Delta)^{\frac{\alpha}{4}} q d x=\int_{\Omega} p(-\Delta)^{\frac{\alpha}{2}} q d \boldsymbol{x}
% \label{eq_24}\end{equation}
% \end{proof}



% \begin{proof}
% Let $\phi(\boldsymbol{x})$ be an arbitrary function with the periodic boundary condition. According to the fact that the fractional Laplacian is linear operator, and the definition of variational derivative, we have
% \begin{equation}
% \begin{aligned}
% \int_{\Omega} \frac{\delta F}{\delta g} \phi(\boldsymbol{x}) d \boldsymbol{x} &=\left[\frac{d}{d \mu} \int_{\Omega} f\left(g+\mu \phi,(-\Delta)^{\frac{\alpha}{4}} g+\mu(-\Delta)^{\frac{\alpha}{4}} \phi\right) d \boldsymbol{x}\right]_{\mu=0} \\
% &=\int_{\Omega}\left(\frac{\partial f}{\partial g} \phi+\frac{\partial f}{\partial\left((-\Delta)^{\frac{\alpha}{4}} g\right)}(-\Delta)^{\frac{\alpha}{4}} \phi\right) d \boldsymbol{x}\\
% &=\int_{\Omega}\left(\frac{\partial f}{\partial g} \phi+\left((-\Delta)^{\frac{\alpha}{4}} \frac{\partial f}{\partial\left((-\Delta)^{\frac{\alpha}{4}} g\right)}\right) \phi\right) d \boldsymbol{x} \\
% &=\int_{\Omega}\left(\frac{\partial f}{\partial g}+(-\Delta)^{\frac{\alpha}{4}} \frac{\partial f}{\partial\left((-\Delta)^{\frac{\alpha}{4}} g\right)}\right) \phi d %\boldsymbol{x}
% \end{aligned}
% \label{eq_27}\end{equation}
% where (\eqref{eq_22}) was used. Based on the fact that $\phi(\boldsymbol{x})$ is arbitrary, by using the fundamental lemma of calculus of variations, we can obtain %(\eqref{eq_26}).
% \end{proof}

%\subsection{Hamiltonian Formulation}	
Setting
\begin{align}
u = p+\mathrm{i}q, u_t = \varphi+ \mathrm{i}\psi,
\end{align}
where $p, q,\varphi,\psi$ are all real-valued functions. Then, NFSWEs \eqref{eq_1}-\eqref{eq_3} can be rewritten as
\begin{align}\label{eq_28}
\varphi_{t}+\mathrm{i}\psi_{t}+\left( -\Delta \right) ^{\frac{\alpha }{2}}p+\mathrm{i}\left( -\Delta \right) ^{\frac{\alpha }{2}}q+\mathrm{i}\kappa \varphi-\kappa \psi+\beta \left( p^{2}+q^{2}\right) \left( p+\mathrm{i} q\right) =0.
\end{align}
Separating the real and imaginary parts from the above equation gives that
\begin{align}
&\varphi_{t}+\left( -\Delta \right) ^{\frac{\alpha }{2}}p-\kappa \psi+\beta \left( p^{2}+q^{2}\right)p=0,\nonumber\\
&\psi_{t}+\left( -\Delta \right) ^{\frac{\alpha }{2}}q+\kappa \varphi+\beta \left( p^{2}+q^{2}\right)q=0.\label{eq_29}
\end{align}
Namely, NFSWEs \eqref{eq_1}-\eqref{eq_3} can be rewritten as an equivalent coupled system
\begin{align}
&\varphi_{t}=-\left( -\Delta \right) ^{\frac{\alpha }{2}}p+\kappa \psi-\beta \left( p^{2}+q^{2}\right)p\label{eq_30},\\
&\psi_{t}=-\left( -\Delta \right) ^{\frac{\alpha }{2}}q-\kappa \varphi-\beta \left( p^{2}+q^{2}\right)q\label{eq_31},\\
&p_t=\varphi, \label{eq_32}\\
&q_t=\psi, \label{eq_33}
\end{align}
where $p, q,\varphi,\psi$ subject to the periodic boundary conditions.

In order to get the Hamiltonian formulation of NFSWEs \eqref{eq_1}-\eqref{eq_3}, we introduce two important lemmas.
%the variational derivative of the functional with fractional Laplacian

\begin{lemma}\label{lem2}
 \cite{wangStructurepreservingNumericalMethods2018} For a functional $F[g]$ with the following form
\begin{align}\label{eq_25}
F[g]=\int_{\Omega} f\left(g(\boldsymbol{x}),(-\Delta)^{\frac{\alpha}{4}} g(\boldsymbol{x})\right) d \boldsymbol{x},
\end{align}
where $f$ is smooth function on $\Omega$, the variational derivative of $F[g]$ is given as follows
\begin{align}\label{eq_26}
\frac{\delta F}{\delta g}=\frac{\partial f}{\partial g}+(-\Delta)^{\frac{\alpha}{4}} \frac{\partial f}{\partial\left((-\Delta)^{\frac{\alpha}{4}} g\right)} .
\end{align}
\end{lemma}

\begin{lemma}\label{lem1}
 \cite{fuStructurepreservingAlgorithmsTwodimensional2020} Given $1<\alpha \leq 2$, then for any real periodic functions $p, q \in L^{2}(\Omega)$, we have
\begin{align}\label{eq_22}
\int_{\Omega}(-\Delta)^{\frac{\alpha}{2}} p q d \boldsymbol{x}=\int_{\Omega}(-\Delta)^{\frac{\alpha}{4}} p(-\Delta)^{\frac{\alpha}{4}} q d \boldsymbol{x}=\int_{\Omega} p(-\Delta)^{\frac{\alpha}{2}} q d \boldsymbol{x}.
\end{align}
\end{lemma}


Based on the above preparation, we can prove the following results.
\begin{theorem}	\label{thm2_1}
Let
\begin{align}
&\mathcal{G}=\kappa\int_{\Omega}(p^2+q^2) d \boldsymbol{x}+2\operatorname{Im}(\int_{\Omega}(\varphi+\mathrm{i}\psi)(p-\mathrm{i}q)d \boldsymbol{x}),\label{eq_34} \\
&\mathcal{H}=\frac{1}{2}\int_{\Omega}\left((\varphi^2+\psi^2)+\left((-\Delta)^{\frac{\alpha}{4}} p\right)^{2}+\left((-\Delta)^{\frac{\alpha}{4}} q\right)^{2}+\frac{\beta}{2}(p^2+q^2)^{2}\right) d \boldsymbol{x}.\label{eq_35}
\end{align}
Then the equivalent system \eqref{eq_30}-\eqref{eq_33} has the following two conservation laws:
\begin{align}
\frac{d}{d t} \mathcal{G}=0, \frac{d}{d t} \mathcal{H}=0.
\end{align}
\end{theorem}

\begin{proof}
Computing the inner product of \eqref{eq_30} and \eqref{eq_31} with $\varphi$ and $\psi$ respectively, one immediately gets the first conservation law.
Noticing that Lemma \ref{lem1}, and taking the inner products of \eqref{eq_30}-\eqref{eq_33} with $\varphi_{t}, \psi_{t}, p_{t},-q_{t}$ respectively, one can deduce that the second conservation law. This proof is completed.
%Similarly, taking the inner products of \eqref{eq_30}-\eqref{eq_33} with $\varphi_{t}, \psi_{t}, p_{t},-q_{t}$ respectively, and noticing that \cite{fuStructurepreservingAlgorithmsTwodimensional2020}
%% Given $1<\alpha \leq 2$, then for any real periodic functions $p, q \in L^{2}(\Omega)$, we have
%\begin{align}\label{eq_22}
%\int_{\Omega}(-\Delta)^{\frac{\alpha}{2}} p q d \boldsymbol{x}=\int_{\Omega}(-\Delta)^{\frac{\alpha}{4}} p(-\Delta)^{\frac{\alpha}{4}} q d \boldsymbol{x}=\int_{\Omega} p(-\Delta)^{\frac{\alpha}{2}} q d \boldsymbol{x}.
%\end{align}
\end{proof}

%In order to get the Hamiltonian form of NFSWEs \eqref{eq_1}-\eqref{eq_3}, we need to introduce two important lemmas.

\begin{theorem}\label{thm2}
	NFSWEs \eqref{eq_1}-\eqref{eq_3} can be reorganized into Hamiltonian system
\begin{equation}\label{eq_37}
	\left(\begin{array}{l}
		\varphi_{t} \\
		\psi_{t} \\
		p_{t} \\
		q_{t}
		\end{array}\right)=J\left(\begin{array}{l}
		\delta \mathcal{H} / \delta \varphi \\
		\delta \mathcal{H} / \delta \psi \\
		\delta \mathcal{H} / \delta p \\
		\delta \mathcal{H} / \delta q
		\end{array}\right),
\end{equation}
where the Hamilton operator
\begin{equation}\label{eq_37b}
J=\left(\begin{array}{cccc}
		0 & \kappa & -1 & 0 \\
		-\kappa & 0 & 0 & -1 \\
		1 & 0 & 0 & 0 \\
		0 & 1 & 0 & 0
		\end{array}\right),
\end{equation}
and the energy functional $\mathcal{H}$ is defined in \eqref{eq_35}.
\end{theorem}

\begin{proof}
Noticing that
\begin{align}\label{eq_12071}
(-\Delta)^{\frac{\alpha}{4}}((-\Delta)^{\frac{\alpha}{4}}  u(\boldsymbol{x},t))&=\mathcal{F}^{-1}\left[|\boldsymbol{\sigma}|^{\frac{\alpha}{2}} \mathcal{F}(\mathcal{F}^{-1}\left[|\boldsymbol{\sigma}|^{\frac{\alpha}{2}} \mathcal{F}(u(\boldsymbol{\sigma},t))\right])\right]\nonumber\\
&=\mathcal{F}^{-1}\left[|\boldsymbol{\sigma}|^{\frac{\alpha}{2}} |\boldsymbol{\sigma}|^{\frac{\alpha}{2}} \mathcal{F}(u(\boldsymbol{\sigma},t))\right]\nonumber\\
&=\mathcal{F}^{-1}\left[|\boldsymbol{\sigma}|^{\alpha} \mathcal{F}(u(\boldsymbol{\sigma},t))\right]\nonumber\\
&=(-\Delta)^{\frac{\alpha}{2}} u(\boldsymbol{x},t),
\end{align}
and applying the fractional variational principle in Lemma \ref{lem2} yields that
\begin{align}
\frac{\delta \mathcal{H}}{\delta p} &=\frac{1}{2}\left(2(-\Delta)^{\frac{\alpha}{2}} p+2 \cdot \frac{\beta}{2}\left(p^{2}+q^{2}\right) \cdot 2 p\right)=(-\Delta)^{\frac{\alpha}{2}}p+\beta\left(p^{2}+q^{2}\right) p,\label{eq_38a}\\
\frac{\delta \mathcal{H}}{\delta q} &=\frac{1}{2}\left(2(-\Delta)^{\frac{\alpha}{2}} q+2 \cdot \frac{\beta}{2}\left(p^{2}+q^{2}\right) \cdot 2 q\right)=(-\Delta)^{\frac{\alpha}{2}}q+\beta\left(p^{2}+q^{2}\right) q,\label{eq_38b}\\
\frac{\delta \mathcal{H}}{\delta \varphi} &=\varphi,\label{eq_38c}\\
\frac{\delta \mathcal{H}}{\delta \psi} &=\psi.\label{eq_38}
\end{align}
This together with the
equivalent form \eqref{eq_30}-\eqref{eq_33} of NFSWEs \eqref{eq_1}-\eqref{eq_3} deduces that
\begin{equation}\label{eq_39}
\left(\begin{array}{l}
		\varphi_{t} \\
		\psi_{t} \\
		p_{t} \\
		q_{t}
\end{array}\right)
=\left(\begin{array}{cccc}
			0 & \kappa & -1 & 0 \\
			-\kappa & 0 & 0 & -1 \\
			1 & 0 & 0 & 0 \\
			0 & 1 & 0 & 0
\end{array}\right)
\left(\begin{array}{l}
		\delta \mathcal{H} / \delta \varphi \\
		\delta \mathcal{H} / \delta \psi \\
		\delta \mathcal{H} / \delta p \\
		\delta \mathcal{H} / \delta q
\end{array}\right).
\end{equation}
This proof is completed.
\end{proof}

	



\subsection{Space Semi-discrete System}
Noticing that the periodic boundary conditions, we choose the Fourier pseudo-spectral method for space discretization of NFSWEs \eqref{eq_1}-\eqref{eq_3}.

Without loss of generality, we set $d=2$.
For positive integer $M$ and even positive integers $N_{x}$ and $N_{y}$, denote $\tau={T}/{M}, h_{x}={2 L}/{N_{x}}, h_{y}={2 L}/{N_{y}}$. Define $\Omega_{h}^{\tau}=\Omega_{h} \times \Omega_{\tau}$, where $\Omega_{h}=\left\{\left(x_{i}, y_{j}\right) \mid i=0,1, \cdots, N_{x}\!-\!1;\right.\\ \left.j=0,1, \cdots, N_{y}\!-\!1\right\}$ and $\Omega_{\tau}=\left\{t_{m} \mid t_{m}=m \tau, 0 \leq m \leq M\right\}$, with $t_{m}=m \tau, x_{i}\!=\!-L+i h_{x}$ and $y_{j}\!=\!-L+j h_{y}$.

For any grid functions $u$ and $v$ defined on $\Omega_h$,
we define the discrete inner product and the associated discrete norms as
\begin{align}\label{eq_48}
(u, v)=h_{x} h_{y} \sum_{i=0}^{N_{x}-1} \sum_{j=0}^{N_{y}-1} u_{i, j} v_{i, j}, \quad\|u\|=(u, u)^{\frac{1}{2}}, \quad\|u\|_{\infty}=\sup _{\left(x_{i}, y_{j}\right) \in \Omega_{h}}\left|u_{i, j}\right|.
\end{align}
For brevity, we introduce following operators
\begin{align}\label{eq_49}
\delta_{t} U^{m}=\frac{U^{m+1}-U^{m}}{\tau}, \quad U^{m+\frac{1}{2}}=\frac{U^{m+1}+U^{m}}{2},
\end{align}
where
\begin{align}\label{eq_47}
&U^m=\left(u_{0,0}^m, \cdots, u_{N_{x}-1,0}^m, u_{0,1}^m, \cdots, u_{N_{x}-1,1}^m, \cdots, u_{0, N_{y}-1}^m, \cdots, u_{N_{x}-1, N_{y}-1}^m\right)^{T}. %\nonumber\\
\end{align}

Let $\left(x_{i}, y_{j}\right) \in \Omega_{h}$ be the Fourier collocation points. Denote $u_{N}(x, y)$ is the
interpolation polynomial function of $u(x, y)$, then we have
\begin{align}\label{eq_50}
u_{N}(x, y)=\sum_{k_{1}=-N_{x} / 2}^{N_{x} / 2} \sum_{k_{2}=-N_{y} / 2}^{N_{y} / 2} \tilde{u}_{k_{1}, k_{2}} e^{\mathrm{i}\mu\left( k_{1} (x+L)+k_{2}(y+L)\right)},
\end{align}
in which $\mu={\pi}/{L}$, and the coefficient
\begin{align}\label{eq_51}
\tilde{u}_{k_{1}, k_{2}}=\frac{1}{N_{x} c_{k_{1}}} \frac{1}{N_{y} c_{k_{2}}} \sum_{l_1=0}^{N_{x}-1} \sum_{l_2=0}^{N_{y}-1} u(x_{l_1}, y_{l_2}) e^{-\mathrm{i}\mu\left( k_{1}(x_{l_1}+L)+k_{2}(y_{l_2}+L)\right)},
\end{align}
where $c_{k_{1}}=1$ for $\left|k_{1}\right|<N_{x} / 2, c_{k_{2}}=1$ for $\left|k_{2}\right|<N_{y} / 2, c_{k_{1}}=2$ for $k_{1}=\pm N_{x} / 2$, and $c_{k_{2}}=2$ for $k_{2}=\pm N_{y} / 2$.
As a result, the fractional Laplacian $(-\Delta)^{\frac{\alpha}{2}} u(x, y)$ can be approximated by
\begin{align}\label{eq_52}
(-\Delta)^{\frac{\alpha}{2}} u_{N}\left(x, y\right)=\sum\limits_{k_{1}=-N_{x} / 2}^{N_{x} / 2} \sum\limits_{k_{2}=-N_{y} / 2}^{N_{y} / 2}\left|\left(k_{1} \mu\right)^{2}+\left(k_{2} \mu\right)^{2}\right|^{\frac{\alpha}{2}} \tilde{u}_{k_{1}, k_{2}} e^{\mathrm{i}\mu\left( k_{1} (x+L)+k_{2}(y+L)\right)},
\end{align}
Inserting \eqref{eq_51} into \eqref{eq_52}, and considering the resulting equation at the point $(x_i,y_j)$ gives that
\begin{align}
&(-\Delta)^{\frac{\alpha}{2}} u_{N}\left(x_{i}, y_{j}\right)\nonumber\\
=&\sum\limits_{l_{1}=0}^{N_{x}-1} \sum\limits_{l_{2}=0}^{N_{y}-1}u(x_{l_{1}}, y_{l_{2}})\left(\sum\limits_{k_{1}=-N_{x} / 2}^{N_{x} / 2} \sum\limits_{k_{2}=-N_{y} / 2}^{N_{y} / 2} \frac{1}{N_{x} c_{k_{1}}} \frac{1}{N_{y} c_{k_{2}}}\left|\mu^{2} \cdot \mathbf{k}^{2}\right|^{\frac{\alpha}{2}} e^{\mathrm{i} \mu\left(k_{1}\left(x_{i}-x_{l_{1}}\right)+k_{2}\left(y_{j}-y_{l_{2}}\right)\right)}\right)\nonumber\\
=&\left(D^{\alpha}U\right)_{i+j N_{x}},\label{eq_53}
\end{align}
where $\mu^{2} \cdot \mathbf{k}^{2}=\mu^{2}\left(k_{1}^{2}+k_{2}^{2}\right)$, $D^{\alpha}$ is spectral symmetric differential matrix with the elements
\begin{align}\label{eq_54}
\left(D^{\alpha}\right)_{i+j N_{x}, l_{1}+l_{2} N_{x}}=\textcolor[rgb]{1.00,0.00,0.00}{\sum\limits_{k_{1}=-N_{x} / 2}^{N_{x} / 2} \sum\limits_{k_{2}=-N_{y} / 2}^{N_{y} / 2}}\frac{1}{N_{x} c_{k_{1}}} \frac{1}{N_{y} c_{k_{2}}}\left|\mu^{2} \cdot \mathbf{k}^{2}\right|^{\frac{\alpha}{2}} e^{\mathrm{i}\mu\left(k_{1}\left(x_{i}-x_{l_{1}}\right)+k_{2}\left(y_{j}-y_{l_{2}}\right)\right)}.
\end{align}


%\begin{remark}
%	\label{rmk1}
%	The spectral differential matrix $D^{\alpha}$ is a symmetric matrix with the elements
%\begin{align}\label{eq_54}
%\left(D^{\alpha}\right)_{i+j N_{x}, l_{1}+l_{2} N_{x}}=-\sum_{\mathbf{k}=-\mathbf{N} / 2}^{\mathbf{N} / 2} \frac{1}{N_{x} c_{k_{1}}} \frac{1}{N_{y} c_{k_{2}}}\left|\mu^{2} \cdot \mathbf{k}^{2}\right|^{\frac{\alpha}{2}} e^{-i \mu\left(k_{1}\left(x_{i}-x_{l_{1}}\right)+k_{2}\left(y_{j}-y_{l_{2}}\right)\right)}.
%\end{align}
%\end{remark}

% \begin{proof}
	
% \begin{equation}
% 	\begin{aligned}
% 	\left(D^{S}\right)_{i+j N_{x}, l_{1}+l_{2} N_{x}} &=-\sum_{\mathbf{k}=-\mathbf{N} / 2}^{\mathbf{N} / 2} \frac{1}{N_{x} c_{k_{1}}} \frac{1}{N_{y} c_{k_{2}}}\left|\mu^{2} \cdot \mathbf{k}^{2}\right|^{\frac{\alpha}{2}} e^{-\mathrm{i} \mu\left(k_{1}\left(x_{i}-x_{l_{1}}\right)+k_{2}\left(y_{j}-y_{l_{2}}\right)\right)} \\
% 	&=-\sum_{\mathbf{k}=-\mathbf{N} / 2}^{\mathbf{N} / 2} \frac{1}{N_{x} c_{k_{1}}} \frac{1}{N_{y} c_{k_{2}}}\left|\mu^{2} \cdot(-\mathbf{k})^{2}\right|^{\frac{\alpha}{2}} e^{-\mathrm{i} \mu\left(\left(-k_{1}\right)\left(x_{l_{1}}-x_{i}\right)+\left(-k_{2}\right)\left(y_{l_{2}}-y_{j}\right)\right)} \\
% 	&=-\sum_{\mathbf{k}=-\mathbf{N} / 2}^{\mathbf{N} / 2} \frac{1}{N_{x} c_{k_{1}}} \frac{1}{N_{y} c_{k_{2}}}\left|\mu^{2} \cdot \mathbf{k}^{2}\right|^{\frac{\alpha}{2}} e^{-\mathrm{i} \mu\left(k_{1}\left(x_{l_{1}}-x_{i}\right)+k_{2}\left(y_{l_{2}}-y_{j}\right)\right)} \\
% 	&=\left(D^{S}\right)_{l_{1}+l_{2} N_{x}, i+j N_{x}}
% 	\end{aligned}
% 	\label{eq_55}\end{equation}
% 	where we have used the fact that $c_{k_{1}}=1$ for $\left|k_{1}\right|<N_{x} / 2, c_{k_{2}}=1$ for $\left|k_{2}\right|<N_{y} / 2, c_{k_{1}}=2$ for $k_{1}=\pm N_{x} / 2$, and $c_{k_{1}}=2$ for $k_{2}=\pm N_{y} / 2 .$ The proof is complete.
% \end{proof}

Applying the Fourier pseudo-spectral method to approximate the previous equivalent system \eqref{eq_30}-\eqref{eq_33} in space gives the space semi-discrete system as follows
\begin{align}
&\varPhi_{t}=\textcolor[rgb]{1.00,0.00,0.00}{-D^{\alpha}P}+\kappa \Psi-\beta \left( P^{2}+Q^{2}\right)\cdot P,\label{eq_56}\\
&\Psi_{t}=\textcolor[rgb]{1.00,0.00,0.00}{-D^{\alpha}Q}-\kappa \varPhi-\beta \left( P^{2}+Q^{2}\right)\cdot Q,\label{eq_57}\\
&P_t=\varPhi,\label{eq_58}\\
&Q_t=\Psi,\label{eq_59}
\end{align}
where $P^{2}=P \cdot P$, and $\cdot$ means the point multiplication between vectors.

Let
\begin{align}\label{eq_60a}
Y=\left(\varPhi^{T}, \Psi^{T}, P^{T}, Q^{T}\right),
\end{align}
then the above semi-discrete system can be rewritten in a canonical Hamiltonian form as
\begin{align}\label{eq_60}
\frac{d Y}{d t}=f(Y)=S \nabla H(Y),
\end{align}
where the Hamiltonian energy is defined by
\begin{align}\label{eq_61}
	H(Y)=\frac{1}{2}\left((\varPhi^{T}\varPhi+\Psi^{T}\Psi)\textcolor[rgb]{1.00,0.00,0.00}{+P^{T} D^{\alpha} P+Q^{T} D^{\alpha} Q}+\frac{\beta}{2}(P^2+Q^2)^{T}(P^2+Q^2)\right),
\end{align}
and $S$ is a skew symmetric matrix with the following form
\begin{align}\label{eq_62}
S=\left(\begin{array}{cccc}
0 & \kappa I & -I & 0 \\
-\kappa I & 0 & 0 & -I \\
I & 0 & 0 & 0 \\
0 & I & 0 & 0
\end{array}\right).
\end{align}

Also, we define the mass
\begin{align}\label{eq_63}
G(Y)=\kappa\|P\|^{2}+\kappa\|Q\|^{2} +2\Psi^{T}P-2\varPhi^{T}Q.
\end{align}

Then we have the following theorem.
\begin{theorem}	\label{thm3}
	The semi-discrete system \eqref{eq_56}-\eqref{eq_59} has the mass and energy conservation laws:
\begin{align}
\frac{d G(Y)}{d t}=0,~\frac{d H(Y)}{d t}=0.
\end{align}
\end{theorem}

\begin{proof}
According to \eqref{eq_63}, one can derives that
\begin{align}\label{eq_64}
\frac{d G(Y)}{d t}=&~2 h_{x} h_{y}\left(\kappa P^{T}P_t+\kappa Q^{T}Q_t+\Psi^{T}_t P+\Psi^{T}P_{t}-\varPhi^{T}_t Q-\varPhi^{T}Q_{t}\right)\nonumber\\
=&~2 h_{x} h_{y}\left(\kappa P^{T}\varPhi+\kappa Q^{T}\Psi \textcolor[rgb]{1.00,0.00,0.00}{- P^{T}D^{\alpha}Q}-\kappa P^{T}\varPhi-\beta P^{T}\left( P^{2}+Q^{2}\right)\cdot Q\right.\nonumber\\
&~\left.+\Psi^{T}\varPhi\textcolor[rgb]{1.00,0.00,0.00}{+Q^{T}D^{\alpha}P}-\kappa Q^{T}\Psi+\beta Q^{T}\left( P^{2}+Q^{2}\right)\cdot P-\varPhi^{T}\Psi\right)\nonumber\\
=&~0.
\end{align}
Based on the skew symmetric of the matrix $S$, it follows from \eqref{eq_60} that
\begin{equation}\label{eq_65}
\frac{d H(Y)}{d t}=\nabla H(Y)^{T} f(Y)=\nabla H(Y)^{T} S \nabla H(Y)=0 .
\end{equation}
This proof is completed.
\end{proof}


\section{Structure-preserving Numerical Methods}\label{Section 3}
\subsection{PAVF-P Scheme}

For NFSWEs \eqref{eq_1}-\eqref{eq_3}, there are many structure-preserving methods, but most of these methods only preserve modified energy or mass, see \cite{liFastEnergyConserving2018,huEfficientEnergyPreserving2022}. This inspired us to construct numerical methods that not only preserve the original energy, but also preserve original mass. Based on the Hamiltonian system \eqref{eq_60} established above, here we apply the partitioned averaged vector field (PAVF) method developed in  \cite{caiPartitionedAveragedVector2018} to construct structure-preserving methods for NFSWEs \eqref{eq_1}-\eqref{eq_3} because the PAVF method preserve not only traditional energy, but possibly other conservation properties.

Considering the Hamiltonian system \eqref{eq_60}, and applying the PAVF method, we can obtain the fully-discrete scheme for solving NFSWEs \eqref{eq_1}-\eqref{eq_3} as follows
\begin{align}
&\delta_{t} \varPhi^{m}\!\!=\!\!\int_{0}^{1}\!\!\kappa H_{\Psi}\!\!\left(\varPhi^{m+1}, \varepsilon \Psi^{m+1}\!\!+\!(1\!\!-\!\varepsilon) \Psi^{m}, P^{m}, Q^{m}\right)\!\!-\!\!H_{P}\!\!\left(\varPhi^{m+1}, \Psi^{m+1}, \varepsilon P^{m+1}\!\!+\!(1\!\!-\!\varepsilon) P^{m}, Q^{m}\right)\!d \varepsilon,\label{eq_70}\\
&\delta_{t} \Psi^{m}\!\!=\!\!\int_{0}^{1}\!\!\!\!-\kappa H_{\varPhi}\!\!\left(\varepsilon \varPhi^{m+1}\!\!+\!(1\!\!-\!\varepsilon) \varPhi^{m}, \Psi^{m}, P^{m}, Q^{m}\right)\!\!-\!\!H_{Q}\!\!\left(\varPhi^{m+1}, \Psi^{m+1}, P^{m+1}, \varepsilon Q^{m+1}\!\!+\!(1\!\!-\!\varepsilon) Q^{m}\right)\!d\varepsilon,\label{eq_71}\\
&\delta_{t} P^{m}\!=\!\int_{0}^{1}\!H_{\varPhi}\left(\varepsilon \varPhi^{m+1}\!+\!(1\!-\!\varepsilon) \varPhi^{m}, \Psi^{m}, P^{m}, Q^{m}\right) d \varepsilon,\label{eq_72}\\
&\delta_{t} Q^{m}\!=\!\int_{0}^{1}\!H_{\Psi}\left(\varPhi^{m+1}, \varepsilon \Psi^{m+1}\!+\!(1\!-\!\varepsilon) \Psi^{m}, P^{m}, Q^{m}\right) d \varepsilon.\label{eq_73}
\end{align}
The above numerical scheme can be further integrated as
\begin{align}
\delta_{t} \varPhi^{m}=&~\kappa \Psi^{m+\frac{1}{2}}\textcolor[rgb]{1.00,0.00,0.00}{-D^{\alpha} P^{m+\frac{1}{2}}}-\frac{\beta}{4}\left( (P^{m+1})^3+ (P^{m})^{2}\cdot P^{m+1}+(P^{m+1})^{2}\cdot P^{m}\right.\nonumber\\
	&+\left. (P^{m})^{3}+2 P^{m+1}\cdot (Q^{m})^{2}+2 P^{m}\cdot (Q^{m})^{2}\right),\label{eq_74}\\
\delta_{t} \Psi^{m}=&-\kappa \varPhi^{m+\frac{1}{2}}\textcolor[rgb]{1.00,0.00,0.00}{-D^{\alpha} Q^{m+\frac{1}{2}}}-\frac{\beta}{4}\left( (Q^{m+1})^3+ (Q^{m})^{2}\cdot Q^{m+1}+(Q^{m+1})^{2}\cdot Q^{m}\right.\nonumber\\
	&+\left. (Q^{m})^{3}+2 Q^{m+1}\cdot (P^{m+1})^{2}+2 Q^{m}\cdot (P^{m+1})^{2}\right),\label{eq_75}\\
\delta_{t} P^{m}=&~\varPhi^{m+\frac{1}{2}},\label{eq_76}\\
\delta_{t} Q^{m}=&~\Psi^{m+\frac{1}{2}}.\label{eq_77}
\end{align}
The proposed fully-discrete scheme \eqref{eq_74}-\eqref{eq_77} will hereafter be called FPAVF (Fourier pseudo-spectral PAVF) scheme. The energy conservation property of the FPAVF scheme can be easily obtained by taking the inner product of \eqref{eq_74}-\eqref{eq_75} with $\delta_t P^{m}$ and $\delta_t Q^{m}$ respectively. Unfortunately this scheme does not guarantee the conservation of mass, which can be reflected in numerical examples.

The adjoint of the FPAVF scheme \eqref{eq_74}-\eqref{eq_77} can be reads as
\begin{align}
\delta_{t} \varPhi^{m}=&~\kappa \Psi^{m+\frac{1}{2}}\textcolor[rgb]{1.00,0.00,0.00}{-D^{\alpha} P^{m+\frac{1}{2}}}-\frac{\beta}{4}\left( (P^{m+1})^3+ (P^{m})^{2}\cdot P^{m+1}+(P^{m+1})^{2}\cdot P^{m}\right.\nonumber\\
	&\left.+ (P^{m})^{3}+2 P^{m+1}\cdot (Q^{m+1})^{2}+2 P^{m}\cdot (Q^{m+1})^{2}\right),\label{eq_86}\\
\delta_{t} \Psi^{m}=&-\kappa \varPhi^{m+\frac{1}{2}}\textcolor[rgb]{1.00,0.00,0.00}{-D^{\alpha} Q^{m+\frac{1}{2}}}-\frac{\beta}{4}\left( (Q^{m+1})^3+ (Q^{m})^{2}\cdot Q^{m+1}+ (Q^{m+1})^{2}\cdot Q^{m}\right.\nonumber\\
	&\left.+ (Q^{m})^{3}+2 Q^{m+1}\cdot (P^{m})^{2}+2 Q^{m}\cdot (P^{m})^{2}\right),\label{eq_87}\\
\delta_{t} P^{m}=&~\varPhi^{m+\frac{1}{2}},\label{eq_88}\\
\delta_{t} Q^{m}=~&\Psi^{m+\frac{1}{2}}.\label{eq_89}
\end{align}

Combining the FPAVF scheme \eqref{eq_74}-\eqref{eq_77} and the adjoint FPAVF scheme \eqref{eq_86}-\eqref{eq_89}, the FPAVF-P (Fourier pseudo-spectral PAVF-P) scheme is given by
\begin{align}
\delta_{t} \varPhi^{m}=&~\kappa \Psi^{m+\frac{1}{2}}\textcolor[rgb]{1.00,0.00,0.00}{-D^{\alpha} P^{m+\frac{1}{2}}}-\frac{\beta}{4}\left((P^{m+1})^3+(P^{m})^{2}\cdot P^{m+1}+(P^{m+1})^{2}\cdot P^{m}\right.\nonumber\\
	&\left.+(P^{m})^{3}+P^{m+1}\cdot (Q^{m})^{2}+P^{m}\cdot (Q^{m})^{2}+P^{m+1}\cdot (Q^{m+1})^{2}+P^{m}\cdot (Q^{m+1})^{2}\right),\label{eq_98}\\
\delta_{t} \Psi^{m}=&-\kappa \varPhi^{m+\frac{1}{2}}\textcolor[rgb]{1.00,0.00,0.00}{-D^{\alpha} Q^{m+\frac{1}{2}}}-\frac{\beta}{4}\left((Q^{m+1})^3+(Q^{m})^{2}\cdot Q^{m+1}+(Q^{m+1})^{2}\cdot Q^{m}\right.\nonumber\\
	&\left.+(Q^{m})^{3}+Q^{m+1}\cdot (P^{m+1})^{2}+Q^{m}\cdot (P^{m+1})^{2}+Q^{m+1}\cdot (P^{m})^{2}+Q^{m}\cdot (P^{m})^{2}\right),\label{eq_99}\\
\delta_{t} P^{m}=&~\varPhi^{m+\frac{1}{2}},\label{eq_100}\\
\delta_{t} Q^{m}=&~\Psi^{m+\frac{1}{2}}.\label{eq_101}
\end{align}


\subsection{Discrete Conservation Laws}
\begin{theorem}\label{thm4}
The FPAVF-P scheme \eqref{eq_98}-\eqref{eq_101} has the following properties of energy-preserving and mass-preserving in discrete sense:
\begin{align}\label{eq_11141}
G^{m+1}=G^{m}, \quad H^{m+1}=H^{m}, \quad 0 \leq m \leq M-1,
\end{align}
where the discrete mass is defined as
\begin{align}\label{eq_11142}
G^{m}=\kappa\|P^{m}\|^2+\kappa\|Q^{m}\|^2+2 \left(\Psi^{m}\right)^T P^{m}-2 \left(\varPhi^{m}\right)^T Q^{m},
\end{align}
and the discrete energy has the form
\begin{align}
H^{m}=&\frac{1}{2}[((\varPhi^{m})^{T}\varPhi^{m}+(\Psi^{m})^{T}\Psi^{m})\textcolor[rgb]{1.00,0.00,0.00}{+(P^{m})^{T} D^{\alpha} P^{m}+(Q^{m})^{T} D^{\alpha} Q^{m}}\nonumber\\
&+\frac{\beta}{2}((P^{m})^2+(Q^{m})^2)^{T}((P^{m})^2+(Q^{m})^2)].\label{eq_800}
\end{align}
\end{theorem}

\begin{proof}
Taking the inner product of \eqref{eq_98} with $Q^{m+1}+Q^{m}$ yields that
\begin{align}
&(Q^{m+1}+Q^{m})^{T}\delta_{t} \varPhi^{m}\nonumber\\
=&~(Q^{m+1}+Q^{m})^{T}\kappa \Psi^{m+\frac{1}{2}}\textcolor[rgb]{1.00,0.00,0.00}{-(Q^{m+1}+Q^{m})^{T}D^{\alpha} P^{m+\frac{1}{2}}}\nonumber\\
&-(Q^{m+1}+Q^{m})^{T}\frac{\beta}{4}\left((P^{m+1})^3+(P^{m})^{2}\cdot P^{m+1}+(P^{m+1})^{2}\cdot P^{m}\right.\nonumber\\
&\left.+(P^{m})^{3}+P^{m+1}\cdot (Q^{m})^{2}+P^{m}\cdot (Q^{m})^{2}+P^{m+1}\cdot (Q^{m+1})^{2}+P^{m}\cdot (Q^{m+1})^{2}\right).\label{eq_11143}
\end{align}
Similarly, taking the inner product of \eqref{eq_99} with $P^{m+1}+P^{m}$ gives that
\begin{align}
&(P^{m+1}+P^{m})^{T}\delta_{t} \Psi^{m}\nonumber\\
=&-(P^{m+1}+P^{m})^{T}\kappa \varPhi^{m+\frac{1}{2}}\textcolor[rgb]{1.00,0.00,0.00}{-(P^{m+1}+P^{m})^{T}D^{\alpha} Q^{m+\frac{1}{2}}}\nonumber\\
&-(P^{m+1}+P^{m})^{T}\frac{\beta}{4}\left((Q^{m+1})^3+(Q^{m})^{2}\cdot Q^{m+1}+(Q^{m+1})^{2}\cdot Q^{m}\right.\nonumber\\
&\left.+(Q^{m})^{3}+Q^{m+1}\cdot (P^{m+1})^{2}+Q^{m}\cdot (P^{m+1})^{2}+Q^{m+1}\cdot (P^{m})^{2}+Q^{m}\cdot (P^{m})^{2}\right)\label{eq_11144}
\end{align}
Subtracting \eqref{eq_11144} from \eqref{eq_11143} deduces that
\begin{align}
&(Q^{m+1}+Q^{m})^{T}\delta_{t} \varPhi^{m}-(P^{m+1}+P^{m})^{T}\delta_{t} \Psi^{m}\nonumber\\
=&~(Q^{m+1}+Q^{m})^{T}\kappa \Psi^{m+\frac{1}{2}}+(P^{m+1}+P^{m})^{T}\kappa \varPhi^{m+\frac{1}{2}}.\label{eq_11145}
\end{align}
Noticing that
$$\delta_t P^m=\varPhi^{m+\frac{1}{2}},~\delta_t Q^m=\Psi^{m+\frac{1}{2}},$$
one gets that
\begin{align}\label{eq_11146}
(Q^{m+1}+Q^{m})^{T}\delta_{t} \varPhi^{m}\!-\!(P^{m+1}+P^{m})^{T}\delta_{t} \Psi^{m}=(Q^{m+1}+Q^{m})^{T}\kappa \delta_t Q^m+(P^{m+1}+P^{m})^{T}\kappa \delta_t P^m.
\end{align}
That is,
\begin{align}
&(Q^{m+1}+Q^{m})^{T}(\varPhi^{m+1}-\varPhi^{m})-(P^{m+1}+P^{m})^{T}(\Psi^{m+1}-\Psi^{m})\nonumber\\
=&~\kappa (\|Q^{m+1}\|^2-\|Q^{m}\|^2)+\kappa (\|P^{m+1}\|^2-\|P^{m}\|^2).\label{eq_11147}
\end{align}
Cross-multiplying \eqref{eq_100} and \eqref{eq_101} yields that
\begin{align}\label{eq_11221}
&((Q^{m+1})^{T}\varPhi^{m+1}-(P^{m+1})^{T}\Psi^{m+1})-((Q^{m})^{T}\varPhi^{m}-(P^{m})^{T}\Psi^{m})\nonumber\\
=&((Q^{m})^{T}\varPhi^{m+1}-(P^{m})^{T}\Psi^{m+1})-((Q^{m+1})^{T}\varPhi^{m}-(P^{m+1})^{T}\Psi^{m}).
\end{align}
Substituting \eqref{eq_11221} into \eqref{eq_11147}, one obtain
\begin{align}
&\kappa \|P^{m+1}\|^2+\kappa \|Q^{m+1}\|^2+2(P^{m+1})^{T}\Psi^{m+1}-2(Q^{m+1})^{T}\varPhi^{m+1}\nonumber
\\=&~\kappa \|P^{m}\|^2+\kappa \|Q^{m}\|^2+2(P^{m})^{T}\Psi^{m}-2(Q^{m})^{T}\varPhi^{m},\label{eq_11155}
\end{align}
which implies that
\begin{align}\label{eq_11149}
G^{m+1}=G^{m} .
\end{align}

Similarly, by taking the discrete inner products of \eqref{eq_98}, \eqref{eq_99} with $\delta_t P^{m}$ and $\delta_t Q^{m}$ respectively, and summing them together, one can obtain the energy conservation law
\begin{align}\label{eq_11156}
H^{m+1}=H^{m}.
\end{align}
This proof is completed.
\end{proof}

\subsection{Other Numerical Methods}
For comparison,  we also give the following two second-order AVF schemes for NFSWEs \eqref{eq_1}-\eqref{eq_3}.
\begin{enumerate}[$\bullet$]
\item The FAVF (Fourier pseudo-spectral AVF) scheme
\begin{align}
\delta_{t} \varPhi =&~\textcolor[rgb]{1.00,0.00,0.00}{-D^{\alpha} P^{m+\frac{1}{2}}}+\kappa \Psi^{m+\frac{1}{2}}-\frac{\beta}{12}\left(3 (P^{m+1})^3-5 (P^{m+1})^2\cdot P^{m}\right.\nonumber\\
		&-5 (P^{m})^2\cdot P^{m+1}+19 (P^{m})^3-6 Q^{m+1}\cdot Q^{m}\cdot P^{m}+2 Q^{m+1}\cdot Q^{m}\cdot P^{m+1} \nonumber\\
		&+\left. 3 (Q^{m+1})^2\cdot P^{m+1}+(Q^{m})^2\cdot P^{m+1}-7 (Q^{m+1})^2\cdot P^{m}+19 (Q^{m} )^2\cdot P^{m}\right),\label{eq_66}\\
\delta_{t} \Psi =&~\textcolor[rgb]{1.00,0.00,0.00}{-D^{\alpha} Q^{m+\frac{1}{2}}}-\kappa \varPhi^{m+\frac{1}{2}}-\frac{\beta}{12}\left(3 (Q^{m+1})^3-5 (Q^{m+1})^2\cdot Q^{m}\right.\nonumber\\
		&-5 (Q^{m})^2\cdot Q^{m+1}+19 (Q^{m})^3-6 P^{m+1}\cdot P^{m}\cdot Q^{m}+2 P^{m+1}\cdot P^{m}\cdot Q^{m+1} \nonumber\\
		&+\left. 3 (P^{m+1})^2\cdot Q^{m+1}+(P^{m})^2\cdot Q^{m+1}-7 (P^{m+1})^2\cdot Q^{m}+19 (P^{m} )^2\cdot Q^{m}\right),\label{eq_67}\\
\delta_{t} P=&~\varPhi^{m+\frac{1}{2}},\label{eq_68}\\
\delta_{t} Q=&~\Psi^{m+\frac{1}{2}}.\label{eq_69}
\end{align}
\item The FPAVF-C (Fourier pseudo-spectral PAVF composition) scheme
\begin{align}
&\frac{1}{\tau}\left(\varPhi^{*}-\varPhi^{m}\right)=\frac{1}{2}\kappa(\Psi^{*}+\Psi^{m})\textcolor[rgb]{1.00,0.00,0.00}{-\frac{1}{2}D^{\alpha} (P^{*}+P^{m})}-\frac{\beta}{4}\left( (P^{*})^3+ (P^{m})^{2}\cdot P^{*}+(P^{*})^{2}\cdot P^{m}\right.\nonumber\\
		&~~~~~~~~~~~~~~~~~~~~\left.+ (P^{m})^{3}+2 P^{*}\cdot (Q^{m})^{2}+2 P^{m}\cdot (Q^{m})^{2}\right),\label{eq_90}\\
&\frac{1}{\tau}\left(\Psi^{*}-\Psi^{m}\right)=-\frac{1}{2}\kappa (\varPhi^{*}+\varPhi^{m})\textcolor[rgb]{1.00,0.00,0.00}{-\frac{1}{2}D^{\alpha} (Q^{*}+Q^{m})}-\frac{\beta}{4}\left( (Q^{*})^3+ (Q^{m})^{2}\cdot Q^{*}+ (Q^{*})^{2}\cdot Q^{m}\right.\nonumber\\
		&~~~~~~~~~~~~~~~~~~~~~\left.+ (Q^{m})^{3}+2 Q^{*}\cdot (P^{*})^{2}+2 Q^{m}\cdot (P^{*})^{2}\right),\label{eq_91}\\
&\frac{1}{\tau}\left(P^{*}-P^{m}\right)=\frac{1}{2}(\varPhi^{*}+\varPhi^{m}),\label{eq_92}\\
&\frac{1}{\tau}\left(Q^{*}-Q^{m}\right)=\frac{1}{2}(\Psi^{*}+\Psi^{m}),\label{eq_93}\\
&\frac{1}{\tau}\left(\varPhi^{m+1}-\varPhi^{*}\right)=\frac{1}{2}\kappa (\Psi^{m+1}+\Psi^{*})\textcolor[rgb]{1.00,0.00,0.00}{-\frac{1}{2}D^{\alpha} P^{m+\frac{1}{2}}}-\frac{\beta}{4}\left((P^{m+1})^3+(P^{*})^{2}\cdot P^{m+1}+(P^{m+1})^{2}\cdot P^{*}\right.\nonumber\\
		&~~~~~~~~~~~~~~~~~~~~~~~\left.+ (P^{*})^{3}+2 P^{m+1}\cdot (Q^{m+1})^{2}+2 P^{*}\cdot (Q^{m+1})^{2}\right),\label{eq_94}\\
&\frac{1}{\tau}\left(\Psi^{m+1}-\Psi^{*}\right)=-\frac{1}{2}\kappa (\varPhi^{m+1}+\varPhi^{*})\textcolor[rgb]{1.00,0.00,0.00}{-\frac{1}{2}D^{\alpha} Q^{m+\frac{1}{2}}}-\frac{\beta}{4}\left((Q^{m+1})^3+(Q^{*})^{2}\cdot Q^{m+1}+(Q^{m+1})^{2}\cdot Q^{*}\right.\nonumber\\
		&~~~~~~~~~~~~~~~~~~~~~~~~\left.+ (Q^{*})^{3}+2 Q^{m+1}\cdot (P^{*})^{2}+2 Q^{*}\cdot (P^{*})^{2}\right),\label{eq_95}\\
&\frac{1}{\tau}\left(P^{m+1}-P^{*}\right)=\frac{1}{2}(\varPhi^{m+1}+\varPhi^{*}),\label{eq_96}\\
&\frac{1}{\tau}\left(Q^{m+1}-Q^{*}\right)=\frac{1}{2}(\Psi^{m+1}+\Psi^{*}),\label{eq_97}
\end{align}
\end{enumerate}
 where $\Phi^*, \Psi^*, P^*, Q^*$ denote the intermediary variables obtained iteratively from the preceding layer and used as inputs to calculate the variables of the subsequent layer.

\begin{remark}\label{rmk1}
Similar to FPAVF-P scheme \eqref{eq_98}-\eqref{eq_101}, it is easy to prove that the above FPAVF scheme \eqref{eq_74}-\eqref{eq_77}, FAVF scheme \eqref{eq_66}-\eqref{eq_69} and the FPAVF-C scheme \eqref{eq_90}-\eqref{eq_97} all preserve the original energy but not the original mass, and the discrete energy has the same form defined in \eqref{eq_800}.
\end{remark}

\begin{remark}\label{rmk2}
It is worth emphasizing that the other exsiting methods for solving NFSWEs \eqref{eq_1}-\eqref{eq_3} that only preserve modified energy and (or) modified mass. For example, the SAV method \cite{chengConvergenceEnergyconservingScheme2022} only preserve modified energy, three-level linearly implicit difference scheme \cite{ranLinearlyImplicitConservative2016} preserve modified energy and mass. However the proposed FPAVF-P scheme \eqref{eq_98}-\eqref{eq_101} preserve both original mass and energy in discrete sense. This is one of the main contributions. Also the FPAVF-P scheme \eqref{eq_98}-\eqref{eq_101} has second-order accuracy in time and spectral accuracy in space.
\end{remark}


\section{Numerical Examples}\label{Section 4}
To support and verify previous theoretical results, some numerical examples are provided in this section.
In our calculation, a fast solver method based on the fast Fourier transformation (FFT) methodology is employed, which can reduce memory requirements and computational complexity.

To obtain numerical errors, we utilize the following error functions
\begin{align}\label{eq_103}
E(\tau)=\left\|U_{N}^{M}-U_{N}^{2 M}\right\|_{\infty},~E(N)=\left\|U_{N}^{M}-U_{2 N}^{M}\right\|_{\infty},
\end{align}
where
$$\left\|U_{N}^{M}-U_{N}^{2 M}\right\|_{\infty}=\left\|U\left(\frac{T}{M}, \frac{L}{N}\right)-U\left(\frac{T}{2 M}, \frac{L}{N}\right)\right\|_{\infty},\left\|U_{N}^{M}-U_{2 N}^{M}\right\|_{\infty}=\left\|U\left(\frac{T}{M}, \frac{L}{N}\right)-U\left(\frac{T}{M}, \frac{L}{2 N}\right)\right\|_{\infty},$$
and the convergence orders in time and space on two successive time step sizes $\tau$ and $\tau / 2$ and two successive polynomial degrees $N$ and $2 N$ are calculated by
\begin{equation}
\text { order }= \left\{
\begin{aligned}
\log _{2}[E(\tau) / E(\tau / 2)], & \text { in time } \\
\log _{2}[E(N) / E(2 N)], & \text { in space. }
\end{aligned}\right.\label{eq_104}
\end{equation}

In order to depict the conservation performance, the relative errors of energy and mass are calculated by
\begin{equation}\label{eq_105}
R H^{n}=\left|\left(H^{n}-H^{0}\right) / H^{0}\right|, \quad R G^{n}=\left|\left(G^{n}-G^{0}\right) / G^{0}\right|,
\end{equation}
where $H^{n}, G^{n}$ denote the discrete energy and mass at $t_n$ respectively.


\begin{example}\label{ex:2}
Firstly, we consider the one dimension NFSWEs \eqref{eq_1}-\eqref{eq_3} as
\begin{equation}\label{eq_108}
u_{t t}+(-\Delta)^{\alpha / 2} u+\mathrm{i}u_t+|u|^2 u=0, \quad (x,t)\in  \Omega\times[0, T],
\end{equation}
with $u(x, 0)=(1+\mathrm{i}) x e^{-10(1-x)^2}$ and $u_t(x, 0)=0$.
\end{example}

Based on the conservation laws in discrete sense given in \eqref{eq_11141}, one has $G^n\equiv G^0$ and $H^n\equiv H^0$, and $G^0, H^0$ only depend on the given initial value functions $u(x,0)$ and $u_t(x, 0)$.
It is not difficult to verify that the initial value function $u(x, 0)$ exponentially decays to zero along $x$ away from $x=1$. It means that
the initial value function could be negligible outside a bounded interval $\Omega$. %Taking into account the limit of machine accuracy,
Here, we take $\Omega=(-25,25)$.
Based on the conservation laws in continuous case defined by \eqref{eq_7}, using the Gaussian numerical integration, we immediately have the original mass $G(0)=0.812482096009503$ for any $\alpha$, and the original energy $E(0)=4.56197648980619$ for $\alpha=2$.

We first compute the convergence orders of above four schemes (the FPAVF-P, FPAVF, FAVF and FPAVF-C schemes) for $T=1$ with respect to $\alpha=1.5$ and $\alpha=2.0$ respectively, see Figs.\ref{fig:1}-\ref{fig:2}.
It is easy to find that the four schemes all have spectral accuracy in space, and the FPAVF scheme exhibits first-order accuracy in time while other schemes exhibit second-order accuracy.

\begin{figure}[H]
\begin{center}
\subfigure[$\tau=1/1000$]{ \centering
\includegraphics[width=0.35\textwidth]{./figure/exp1_s1.5.eps}
%\centerline{($b$) Spatial accuracy with $\tau = 10^{-3}.$}
}\subfigure[$N=128$]{ \centering
\includegraphics[width=0.35\textwidth]{./figure/exp1_t1.5.eps}
%\centerline{($a$) Temporal accuracy with $N=128.$}
}\caption{Convergence orders of four schemes for Example \ref{ex:2} with $\alpha=1.5$.} \label{fig:1}
\end{center}
\end{figure}

\begin{figure}[H]
\begin{center}
\subfigure[$\tau=1/1000$]{ \centering
\includegraphics[width=0.35\textwidth]{./figure/exp1_s2.eps}
%\centerline{($b$) Spatial accuracy with $\tau = 10^{-3}.$}
}\subfigure[$N=128$]{ \centering
\includegraphics[width=0.35\textwidth]{./figure/exp1_t2.eps}
%\centerline{($a$) Temporal accuracy with $N=128.$}
}\caption{Convergence orders of four schemes for Example \ref{ex:2} with $\alpha=2.0$.} \label{fig:2}
\end{center}
\end{figure}

Now we focus on the conservation performance of the existing methods. The evolution of the discrete energy over a long period of time is shown in Fig.\ref{fig:3}, which are calculated by $N=512$ and $\tau=0.01$ for different $\alpha$ respectively. One can observe that, especially from the results of $\alpha=2$, the discrete energy computed by the FPAVF-P, FPAVF, FAVF and FPAVF-C schemes are convergent uniformly to the original energy, but the SAV method \cite{chengConvergenceEnergyconservingScheme2022} and three-level linearly implicit difference scheme \cite{ranLinearlyImplicitConservative2016} have poor performance. This phenomenon is consistent with the latter preserves only a modified energy rather than the original energy.

\begin{figure}[H]
	\begin{center}
	\subfigure[$\alpha=1.3$]{ \centering
	\includegraphics[width=0.4\textwidth]{./figure/exp1_H1.3.eps}
	%\centerline{($a$) $\alpha=1.3$}
	}\subfigure[$\alpha=1.6$]{ \centering
	\includegraphics[width=0.4\textwidth]{./figure/exp1_H1.6.eps}
	%\centerline{($b$) $\alpha=1.6$}
	}\\
	\subfigure[$\alpha=1.9$]{ \centering
	\includegraphics[width=0.4\textwidth]{./figure/exp1_H1.9.eps}
	%\centerline{($d$) $\alpha=2.0$}
	}\subfigure[$\alpha=2.0$]{ \centering
	\includegraphics[width=0.4\textwidth]{./figure/exp1_H2.eps}
	%\centerline{($d$) $\alpha=2.0$}
	}\caption{Discrete energy for different $\alpha$ in Example \ref{ex:2} with $N = 512$ and $\tau=0.01$.} \label{fig:3}
	\end{center}
	\end{figure}

Similarly, the evolution of the discrete mass over a long period of time is shown in Fig.\ref{fig:4}. It should be emphasized that the SAV method does not have conservation of mass.
One can see that the FPAVF-P scheme is convergent uniformly to the original mass, other methods have relatively poor performance especially the FAVF scheme, and the three-level linearly implicit difference scheme preserves a modified mass. Also the discrete mass based on FPAVF-C scheme shows frequent oscillations on a small scale.

\begin{figure}[H]
	\begin{center}
	 \subfigure[$\alpha=1.3$]{ \centering
	\includegraphics[width=0.4\textwidth]{./figure/exp1_M1.3.eps}
	%\centerline{($a$) $\alpha=1.3$}
	}\subfigure[$\alpha=1.6$]{ \centering
	\includegraphics[width=0.4\textwidth]{./figure/exp1_M1.6.eps}
	%\centerline{($b$) $\alpha=1.6$}
	}\\
	 \subfigure[$\alpha=1.9$]{ \centering
	\includegraphics[width=0.4\textwidth]{./figure/exp1_M1.9.eps}
	%\centerline{($c$) $\alpha=1.9$}
	}\subfigure[$\alpha=2.0$]{ \centering
	\includegraphics[width=0.4\textwidth]{./figure/exp1_M2.eps}
	%\centerline{($d$) $\alpha=2.0$}
	}\caption{Discrete mass for different $\alpha$ in Example \ref{ex:2} with $N = 512$ and $\tau=0.01$.} \label{fig:4}
	\end{center}
	\end{figure}


More precisely, the values of discrete energy $H^n$ and discrete mass $G^n$ at different times $t=t_n$ for different $\alpha$ are shown in Tables \ref{tab:1}-\ref{tab:4},
which are obtained by taking $N=512$ and $\tau=0.01$. From Table \ref{tab:1}, one can see that the proposed four schemes preserve the original energy, but the SAV scheme and linearly implicit difference scheme only preserve a modified energy. Similarly, from Tables \ref{tab:2}-\ref{tab:4}, we observe that the FPAVF-P scheme is convergent uniformly to the original mass, other methods have poor performance and the three-level linearly implicit scheme only conserves modified mass.



\begin{table}[H]\small
	\centering
	\caption{Discrete energy $H^n$ at time $t=t_n$ for Example \ref{ex:2} when $\alpha=2$.}
	  \begin{tabular}{lllllll}
	  \toprule
       $t$   &FAVF   &FPAVF   &FPAVF-C   &SAV    &Linear-Implicit   &FPAVF-P\\
	  \midrule
	  0     &4.561976489785   &4.561976489785   &4.561976489785   &4.457414815200   &4.453861069486   &4.561976489785 \\
	  10    &4.561976489785   &4.561976489785   &4.561976489785   &4.457414815200   &4.453861069486   &4.561976489785 \\
	  100   &4.561976489785   &4.561976489785   &4.561976489782   &4.457414815197   &4.453861069489   &4.561976489785 \\
	  200   &4.561976489785   &4.561976489785   &4.561976489779   &4.457414815195   &4.453861069492   &4.561976489785 \\
	  300   &4.561976489785   &4.561976489785   &4.561976489776   &4.457414815192   &4.453861069494   &4.561976489785 \\
	  400   &4.561976489785   &4.561976489785   &4.561976489772   &4.457414815190   &4.453861069497   &4.561976489785 \\
	  500   &4.561976489785   &4.561976489785   &4.561976489768   &4.457414815187   &4.453861069500   &4.561976489785 \\
	  \midrule
	  \multicolumn{7}{r}{Original energy:~4.56197648980619} \\
	  \bottomrule
	  \end{tabular}\label{tab:1}%
  \end{table}%


\begin{table}[H]\small
	\centering
	\caption{Discrete mass $G^n$ at time $t=t_n$ for Example \ref{ex:2} when $\alpha=1.3$.}
	  \begin{tabular}{llllll}
	  \toprule
$t$   &FAVF   &FPAVF   &FPAVF-C   &Linear-Implicit   &FPAVF-P\\
	  \midrule
	  0     &0.812482096011643   &0.812486108372853   &0.812481093228288   &0.812269212105079   &0.812482096009232 \\
	  10    &0.812481652913507   &0.815448411130831   &0.812482228623069   &0.812269212105449   &0.812482096009234 \\
	  100   &0.812479701090339   &0.815337307670638   &0.812482081439882   &0.812269212105119   &0.812482096009236 \\
	  200   &0.812476755660814   &0.815352772611703   &0.812482091028916   &0.812269212105298   &0.812482096009256 \\
	  300   &0.812471706145304   &0.815369448311709   &0.812482102752682   &0.812269212105193   &0.812482096009262 \\
	  400   &0.812466871593141   &0.815375406648485   &0.812482112407629   &0.812269212105361   &0.812482096009263 \\
	  500   &0.812463332390332   &0.815391313914498   &0.812482125179718   &0.812269212105409   &0.812482096009261 \\
	  \midrule
	  \multicolumn{6}{r}{Original mass:~0.812482096009503} \\
	  \bottomrule
	  \end{tabular}\label{tab:2}%
  \end{table}%


\begin{table}[H]\small
	\centering
	\caption{Discrete mass $G^n$ at time $t=t_n$ for Example \ref{ex:2} when $\alpha=1.6$.}
	  \begin{tabular}{llllll}
	  \toprule
$t$   &FAVF   &FPAVF   &FPAVF-C   &Linear-Implicit   &FPAVF-P\\
	  \midrule
	  0     &0.812482096014526   &0.812487932904355   &0.812480637459791   &0.812191342790779   &0.812482096009232 \\
	  10    &0.812479542844467   &0.815290680597744   &0.812482338980161   &0.812191342790869   &0.812482096009234 \\
	  100   &0.812471993678066   &0.814964610988901   &0.812482077830270   &0.812191342790519   &0.812482096009245 \\
	  200   &0.812465076996841   &0.814934135072654   &0.812482168949170   &0.812191342790438   &0.812482096009252 \\
	  300   &0.812461964307183   &0.815026734196011   &0.812482132284732   &0.812191342790211   &0.812482096009255 \\
	  400   &0.812456227758388   &0.815045189971354   &0.812482132454783   &0.812191342790067   &0.812482096009255 \\
	  500   &0.812447472460440   &0.815097180030255   &0.812482122664758   &0.812191342789578   &0.812482096009251 \\
	  \midrule
	  \multicolumn{6}{r}{Original mass:~0.812482096009503} \\
	  \bottomrule
	  \end{tabular}\label{tab:3}%
  \end{table}%


\begin{table}[H]\small
	\centering
	\caption{Discrete mass $G^n$ at time $t=t_n$ for Example \ref{ex:2} when $\alpha=2$.}
	  \begin{tabular}{llllll}
	  \toprule
$t$   &FAVF   &FPAVF   &FPAVF-C   &Linear-Implicit   &FPAVF-P\\
	  \midrule
	  0     &0.812482096027426   &0.812492566135382   &0.812479480708946   &0.812007279829162   &0.812482096009232 \\
	  10    &0.812501574603936   &0.815690689466538   &0.812482208549750   &0.812007279829185   &0.812482096009233 \\
	  100   &0.812485179319911   &0.815559529804266   &0.812482224295188   &0.812007279829068   &0.812482096009234 \\
	  200   &0.812436598720768   &0.815737264057778   &0.812482177481325   &0.812007279828906   &0.812482096009234 \\
	  300   &0.812395565737519   &0.815914179675223   &0.812482122649446   &0.812007279828999   &0.812482096009235 \\
	  400   &0.812353830841431   &0.816227202656059   &0.812482101787071   &0.812007279828969   &0.812482096009235 \\
	  500   &0.812317849493374   &0.816336221770707   &0.812482109657662   &0.812007279829037   &0.812482096009234 \\
	  \midrule
	  \multicolumn{6}{r}{Original mass:~0.812482096009503} \\
	  \bottomrule
	  \end{tabular}\label{tab:4}%
  \end{table}%



Based on the fact that the original energy for $\alpha\ne 2$ is not easy to calculate, we verify the discrete conservation laws from the view of relative error, see Figs.\ref{fig:5}-\ref{fig:6}. Again, these figures show that the FPAVF-P scheme has the best performance in terms of preserves original mass. And with the increase of $\alpha$, its performance of preserving the original energy will be better. These observations are compatible with our previous theoretical results.




\begin{figure}[H]
\begin{center}
 \subfigure[$\alpha=1.3$]{ \centering
\includegraphics[width=0.3\textwidth]{./figure/exp1_RM1.3.eps}
%\centerline{($a$) $\alpha=1.3$}
}\subfigure[$\alpha=1.6$]{ \centering
\includegraphics[width=0.3\textwidth]{./figure/exp1_RM1.6.eps}
%\centerline{($b$) $\alpha=1.6$}
}\subfigure[$\alpha=1.9$]{ \centering
\includegraphics[width=0.3\textwidth]{./figure/exp1_RM1.9.eps}
%\centerline{($c$) $\alpha=1.9$}
}\caption{The relative errors of discrete mass for different $\alpha$ in Example \ref{ex:2} with $N = 512$ and $\tau=0.01$.} \label{fig:5}
\end{center}
\end{figure}

\begin{figure}[H]
\begin{center}
 \subfigure[$\alpha=1.3$]{ \centering
\includegraphics[width=0.3\textwidth]{./figure/exp1_RH1.3.eps}
%\centerline{($a$) $\alpha=1.3$}
}\subfigure[$\alpha=1.6$]{ \centering
\includegraphics[width=0.3\textwidth]{./figure/exp1_RH1.6.eps}
%\centerline{($b$) $\alpha=1.6$}
} \subfigure[$\alpha=1.9$]{ \centering
\includegraphics[width=0.3\textwidth]{./figure/exp1_RH1.9.eps}
%\centerline{($c$) $\alpha=1.9$}
}\caption{The relative errors of discrete energy for different $\alpha$ in Example \ref{ex:2} with $N = 512$ and $\tau=0.01$.} \label{fig:6}
\end{center}
\end{figure}



\begin{example}\label{ex:4}
Now we consider the two-dimensional NFSWEs \eqref{eq_1}-\eqref{eq_3} with initial values
\begin{equation}\label{eq_110}
u(x,y, 0)=\mbox{sech}\left(x^2+y^2\right), u_t(x,y, 0)=\sin (x+y) \mbox{sech}\left(-2(x^2+y^2)\right), (x,y,t)\in  \Omega\times[0, T],
\end{equation}
where $\Omega=[-5,5] \times[-5,5]$.
\end{example}


Similar to one dimensional case, we first compute the convergence orders of the FPAVF-P, FPAVF, FAVF and FPAVF-C schemes for $T=1$ when $\alpha=1.5$ and $\alpha=2.0$ respectively. The change of errors are shown in Figs.\ref{fig:7}-\ref{fig:8}. We can clearly observe that the four schemes all have spectral accuracy in space, and the FPAVF scheme exhibits first-order accuracy while other schemes exhibit second-order accuracy in time.

\begin{figure}[H]
\begin{center}
\subfigure[$\tau=1/1000$]{ \centering
\includegraphics[width=0.35\textwidth]{./figure/exp2_s1.5.eps}
%\centerline{($b$) Spatial accuracy with $\tau = 10^{-3}.$}
}\subfigure[$N=16$]{ \centering
\includegraphics[width=0.35\textwidth]{./figure/exp2_t1.5.eps}
%\centerline{($a$) Temporal accuracy with $N=128.$}
}\caption{Convergence orders of four schemes for Example \ref{ex:4} with $\alpha=1.5$.} \label{fig:7}
\end{center}
\end{figure}

\begin{figure}[H]
\begin{center}
\subfigure[$\tau=1/1000$]{ \centering
\includegraphics[width=0.35\textwidth]{./figure/exp2_s2.eps}
%\centerline{($b$) Spatial accuracy with $\tau = 10^{-3}.$}
}\subfigure[$N=16$]{ \centering
\includegraphics[width=0.35\textwidth]{./figure/exp2_t2.eps}
%\centerline{($a$) Temporal accuracy with $N=128.$}
}\caption{Convergence orders of four schemes for Example \ref{ex:4} with $\alpha=2.0$.} \label{fig:8}
\end{center}
\end{figure}


For comparison the structure preserving ability with the existing methods, we first calculated the original mass and energy.
Noticing that the original mass $G(t)$ is independent of $\alpha$, by using the Gaussian numerical integration, we obtain the original mass $G(0)=3.14159265323701$ for any $\alpha$. Similarly, we can get the original energy $E(0)=3.22697078976648$ for $\alpha=2$.

Unlike the one-dimensional problem, there is no three-level linear implicit scheme for two-dimensional cases, so below we only compare the performance of the SAV method, and FPAVF-P, FAVF and FPAVF-C schemes proposed in this paper. The evolution of the discrete mass and discrete energy over a long period of time are shown in Figs.\ref{fig:9}-\ref{fig:10}, which are calculated by $N=64$ and $\tau=0.01$ for different $\alpha$ respectively.
Also the change of this relative error of discrete mass and energy over time are shown in Figs.\ref{fig:11}-\ref{fig:12}.
One can observe that the FPAVF-P scheme is convergent uniformly to the original mass, other three methods have poor performance especially the FAVF scheme and FPAVF scheme (the result with respect to FPAVF scheme is not shown here because it is even worse).
And the three schemes proposed in this paper all can preserve the original energy invariance very well, the SAV method only conserves a modified energy.
These phenomena once again confirm the correctness of our theoretical results.


\begin{figure}[H]
	\begin{center}
	 \subfigure[$\alpha=1.3$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_M1.3.eps}
	%\centerline{($a$) $\alpha=1.3$}
	}\subfigure[$\alpha=1.6$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_M1.6.eps}
	%\centerline{($b$) $\alpha=1.6$}
	}\\
	 \subfigure[$\alpha=1.9$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_M1.9.eps}
	%\centerline{($c$) $\alpha=1.9$}
	}\subfigure[$\alpha=2.0$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_M2.eps}
	%\centerline{($d$) $\alpha=2.0$}
	}\caption{Discrete mass for different $\alpha$ in Example \ref{ex:4} with $N = 64$ and $\tau=0.01$.} \label{fig:9}
	\end{center}
	\end{figure}

\begin{figure}[H]
	\begin{center}
	\subfigure[$\alpha=1.3$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_H1.3.eps}
	%\centerline{($a$) $\alpha=1.3$}
	}\subfigure[$\alpha=1.6$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_H1.6.eps}
	%\centerline{($b$) $\alpha=1.6$}
	}\\
	\subfigure[$\alpha=1.9$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_H1.9.eps}
	%\centerline{($d$) $\alpha=2.0$}
	}\subfigure[$\alpha=2.0$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_H2.eps}
	%\centerline{($d$) $\alpha=2.0$}
	}\caption{Discrete energy for different $\alpha$ in Example \ref{ex:4} with $N = 64$ and $\tau=0.01$.} \label{fig:10}
	\end{center}
	\end{figure}


\begin{figure}[H]
\begin{center}
 \subfigure[$\alpha=1.3$]{ \centering
\includegraphics[width=0.3\textwidth]{./figure/exp2_RM1.3.eps}
%\centerline{($a$) $\alpha=1.3$}
}\subfigure[$\alpha=1.6$]{ \centering
\includegraphics[width=0.3\textwidth]{./figure/exp2_RM1.6.eps}
%\centerline{($b$) $\alpha=1.6$}
}\subfigure[$\alpha=1.9$]{ \centering
\includegraphics[width=0.3\textwidth]{./figure/exp2_RM1.9.eps}
%\centerline{($c$) $\alpha=1.9$}
}\caption{The relative errors of discrete mass for different $\alpha$ in Example \ref{ex:4} with $N = 64$ and $\tau=0.01$.} \label{fig:11}
\end{center}
\end{figure}


\begin{figure}[H]
\begin{center}
 \subfigure[$\alpha=1.3$]{ \centering
\includegraphics[width=0.3\textwidth]{./figure/exp2_RH1.3.eps}
%\centerline{($a$) $\alpha=1.3$}
}\subfigure[$\alpha=1.6$]{ \centering
\includegraphics[width=0.3\textwidth]{./figure/exp2_RH1.6.eps}
%\centerline{($b$) $\alpha=1.6$}
} \subfigure[$\alpha=1.9$]{ \centering
\includegraphics[width=0.3\textwidth]{./figure/exp2_RH1.9.eps}
%\centerline{($c$) $\alpha=1.9$}
}\caption{The relative errors of discrete energy for different $\alpha$ in Example \ref{ex:4} with $N = 64$ and $\tau=0.01$.} \label{fig:12}
\end{center}
\end{figure}

A more detailed comparison is shown in Tables \ref{tab:4-1}-\ref{tab:4-4}, and we can reach the same conclusion by observing theses data.
%The values of discrete energy $H^n$ and discrete mass $G^n$ at different times for different $\alpha$ are shown in Tables \ref{tab:4-1}-\ref{tab:4-4},
%which are obtained by taking $N=128$ and $\tau=0.01$. From Table \ref{tab:4-1}, one can see that the proposed four schemes preserve the original energy, but the SAV scheme and linearly implicit difference scheme only preserve a modified energy. Similarly, from Tables \ref{tab:4-2}-\ref{tab:4-4}, we observe that the FPAVF-P scheme is convergent uniformly to the original mass, other methods have poor performance especially the FPAVF scheme and three-level linearly implicit scheme.


\begin{table}[H]\small
	\centering
	\caption{Discrete energy $H^n$ at time $t=t_n$ for Example \ref{ex:4} when $\alpha=2$.}
	  \begin{tabular}{llllll}
	  \toprule
       $t$   &FAVF   &FPAVF   &FPAVF-C   &SAV   &FPAVF-P\\
	  \midrule
	  0     & 3.22697078740176 & 3.22697078740176 & 3.22697078740173 & 3.21234862767094 & 3.22697078740176 \\
	  10    & 3.22697078740176 & 3.22697078740176 & 3.22697078740168 & 3.21234862767062 & 3.22697078740176 \\
	  20    & 3.22697078740176 & 3.22697078740176 & 3.22697078740172 & 3.21234862767066 & 3.22697078740176 \\
	  40    & 3.22697078740175 & 3.22697078740176 & 3.22697078740182 & 3.21234862767033 & 3.22697078740176 \\
	  60    & 3.22697078740176 & 3.22697078740176 & 3.22697078740191 & 3.21234862767035 & 3.22697078740176 \\
	  80    & 3.22697078740176 & 3.22697078740175 & 3.22697078740199 & 3.21234862767073 & 3.22697078740176 \\
	  100   & 3.22697078740175 & 3.22697078740176 & 3.22697078740207 & 3.21234862767045 & 3.22697078740176 \\
	  \midrule
	  \multicolumn{6}{r}{Original energy:~3.22697078976648} \\
	  \bottomrule
	  \end{tabular}\label{tab:4-1}%
  \end{table}%


  % Table generated by Excel2LaTeX from sheet 'Sheet1'
\begin{table}[H]\small
	\centering
	\caption{Discrete mass $G^n$ at time $t=t_n$ for Example \ref{ex:4} when $\alpha=1.3$.}
	  \begin{tabular}{lllll}
	  \toprule
$t$   &FAVF   &FPAVF   &FPAVF-C   &FPAVF-P\\
	  \midrule
	  0     & 3.14159297667455 & 3.14159361842152 & 3.14159241227909 & 3.14159265358976 \\
	  10    & 3.14160952253933 & 3.13595374862870 & 3.14166505643569 & 3.14159265358963 \\
	  20    & 3.14161343543099 & 3.14421089321261 & 3.14158965037808 & 3.14159265358952 \\
	  40    & 3.14157539023564 & 3.14362067013654 & 3.14159917106759 & 3.14159265358932 \\
	  60    & 3.14150249358846 & 3.14217508702013 & 3.14159868539556 & 3.14159265358912 \\
	  80    & 3.14143174175214 & 3.14159826267015 & 3.14158946625201 & 3.14159265358895 \\
	  100   & 3.14135672071641 & 3.14328710863969 & 3.14158227319751 & 3.14159265358880 \\
	  \midrule
	  \multicolumn{5}{r}{Original mass:~3.14159265323701} \\
	  \bottomrule
	  \end{tabular}\label{tab:4-2}%
  \end{table}%

  % Table generated by Excel2LaTeX from sheet 'Sheet1'
\begin{table}[H]\small
	\centering
	\caption{Discrete mass $G^n$ at time $t=t_n$ for Example \ref{ex:4} when $\alpha=1.6$.}
	  \begin{tabular}{lllll}
	  \toprule
$t$   &FAVF   &FPAVF   &FPAVF-C   &FPAVF-P\\
	  \midrule
	  0     & 3.14159297668940 & 3.14159361814729 & 3.14159241218683 & 3.14159265358976 \\
	  10    & 3.14163389358031 & 3.13754191888209 & 3.14160072631792 & 3.14159265358928 \\
	  20    & 3.14161716177523 & 3.14433222488425 & 3.14159044899067 & 3.14159265358919 \\
	  40    & 3.14149554093894 & 3.14475213344308 & 3.14160500647197 & 3.14159265358901 \\
	  60    & 3.14139997924855 & 3.14288256207779 & 3.14160023436812 & 3.14159265358885 \\
	  80    & 3.14127488637752 & 3.14241392600216 & 3.14158768432513 & 3.14159265358871 \\
	  100   & 3.14115287766347 & 3.14489331385338 & 3.14159412822417 & 3.14159265358860 \\
		\midrule
	  \multicolumn{5}{r}{Original mass:~3.14159265323701} \\
	  \bottomrule
	  \end{tabular}\label{tab:4-3}%
  \end{table}%

  % Table generated by Excel2LaTeX from sheet 'Sheet1'
\begin{table}[H]\small
	\centering
	\caption{Discrete mass $G^n$ at time $t=t_n$ for Example \ref{ex:4} when $\alpha=2$.}
	  \begin{tabular}{lllll}
	  \toprule
$t$   &FAVF   &FPAVF   &FPAVF-C   &FPAVF-P\\
	  \midrule
	  0     & 3.14159297725470 & 3.14159361919902 & 3.14159241149324 & 3.14159265358976 \\
	  10    & 3.14168000260412 & 3.14369215006721 & 3.14160070161208 & 3.14159265358976 \\
	  20    & 3.14164544531849 & 3.14521250122401 & 3.14158745249453 & 3.14159265358976 \\
	  40    & 3.14150535695500 & 3.14531702832209 & 3.14160031804829 & 3.14159265358976 \\
	  60    & 3.14136438511727 & 3.14552013864766 & 3.14159560564481 & 3.14159265358976 \\
	  80    & 3.14118013227991 & 3.14739329967543 & 3.14158800109644 & 3.14159265358976 \\
	  100   & 3.14101125059928 & 3.15011874273391 & 3.14154787019595 & 3.14159265358976 \\
	  \midrule
	  \multicolumn{5}{r}{Original mass:~3.14159265323701} \\
	  \bottomrule
	  \end{tabular}\label{tab:4-4}%
  \end{table}%

%
%Based on the fact that the original energy for $\alpha\ne 2$ is not easy to calculate, we verify the discrete conservation laws from the perspective of relative error, see Figs.\ref{fig:4-5}-\ref{fig:4-6}. Again, these figures show that the FPAVF-P scheme has almost the best performance in terms of preserves original energy and original mass. These observations are compatible with our previous theoretical results.

% \begin{remark}
% 	\label{rmk3}
% 	\textcolor[rgb]{1.00,0.00,0.00}{In Table \ref{tab:4-1}, we calculate the discrete energy of the SAV method by N=32, while the other four schemes are calculated by N=128.
% This is due to the fact that the SAV method is relatively inefficient in two-dimensional calculations and can only be theoretically proven to preserve the modified energy rather than the original energy \cite{chengNewLagrangeMultiplier2020}.}
% \end{remark}
Finally, we depict the evolution of waves over time $t$ for $\alpha=1.3,1.6,1.99,2$ in Figs.\ref{fig:13}-\ref{fig:16} respectively, which are obtained by taking $N=128$ and $\tau=0.01$. We can observe that the order $\alpha$ will significantly affect the shape of the waves, and the shape of the wave changes faster when $\alpha$ becomes larger. Specifically, the numerical solutions converges to the classical nonlinear Schr{\"o}dinger wave equation when $\alpha \rightarrow 2$, see \cite{zhangConservativeNumericalScheme2003,liCompactFiniteDifference2012,wangAnalysisNewConservative2006}.
%Finally, Figs.\ref{fig:4-5}-\ref{fig:4-10} show the plots of $\left|U^n\right|$ for $\alpha=1.3,1.6,1.99,2$ at different times, which are obtained by taking $N=128$ and $\tau=0.01$.
%We show that the order $\alpha$ will significantly affect the shape of the solitons.
%It is also observed from Figs. \ref{fig:4-5}-\ref{fig:4-10} that the shape of the soliton changes faster when $\alpha$ becomes larger, and when $\alpha \rightarrow 2$,
%the discrete solution converges to the classical nonlinear Schr{\"o}dinger equation with wave operator, see \cite{zhangConservativeNumericalScheme2003,liCompactFiniteDifference2012,wangAnalysisNewConservative2006}.
%---------------------------------------------------------------------------------------------------------------------------
\begin{figure}[H]
	\begin{center}
	 \subfigure[$t=0s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour3_p0.eps}
	}\subfigure[$t=1s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour3_p1.eps}
	} \subfigure[$t=5s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour3_p5.eps}
	}\\
	\subfigure[$t=10s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour3_p10.eps}
	}\subfigure[$t=50s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour3_p50.eps}
	} \subfigure[$t=100s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour3_p100.eps}
	}\caption{The pictures of wave propagation for Example \ref{ex:4} with $\alpha=1.3.$}\label{fig:13}
	\end{center}
	\end{figure}
%---------------------------------------------------------------------------------------------------------------------------
% \begin{figure}[H]
% 	\begin{center}
% 	 \subfigure[$t=0s$]{ \centering
% 	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour5_p0.eps}
% 	}\subfigure[$t=1s$]{ \centering
% 	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour5_p1.eps}
% 	} \subfigure[$t=5s$]{ \centering
% 	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour5_p5.eps}
% 	}\\
% 	\subfigure[$t=10s$]{ \centering
% 	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour5_p10.eps}
% 	}\subfigure[$t=50s$]{ \centering
% 	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour5_p50.eps}
% 	} \subfigure[$t=100s$]{ \centering
% 	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour5_p100.eps}
% 	}\caption{\label{fig:4-6}The pictures of wave propagation for Example \ref{ex:4} with $\alpha=1.5.$}
% 	\end{center}
% 	\end{figure}
%---------------------------------------------------------------------------------------------------------------------------
\begin{figure}[H]
	\begin{center}
	 \subfigure[$t=0s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour6_p0.eps}
	}\subfigure[$t=1s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour6_p1.eps}
	} \subfigure[$t=5s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour6_p5.eps}
	}\\
	\subfigure[$t=10s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour6_p10.eps}
	}\subfigure[$t=50s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour6_p50.eps}
	} \subfigure[$t=100s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour6_p100.eps}
	}\caption{The pictures of wave propagation for Example \ref{ex:4} with $\alpha=1.6.$}\label{fig:14}
	\end{center}
	\end{figure}
%---------------------------------------------------------------------------------------------------------------------------
% \begin{figure}[H]
% 	\begin{center}
% 	 \subfigure[$t=0s$]{ \centering
% 	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour9_p0.eps}
% 	}\subfigure[$t=1s$]{ \centering
% 	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour9_p1.eps}
% 	} \subfigure[$t=5s$]{ \centering
% 	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour9_p5.eps}
% 	}\\
% 	\subfigure[$t=10s$]{ \centering
% 	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour9_p10.eps}
% 	}\subfigure[$t=50s$]{ \centering
% 	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour9_p50.eps}
% 	} \subfigure[$t=100s$]{ \centering
% 	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour9_p100.eps}
% 	}\caption{\label{fig:4-8}The pictures of wave propagation for Example \ref{ex:4} with $\alpha=1.9.$}
% 	\end{center}
% 	\end{figure}
%---------------------------------------------------------------------------------------------------------------------------
\begin{figure}[H]
	\begin{center}
	 \subfigure[$t=0s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour99_p0.eps}
	}\subfigure[$t=1s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour99_p1.eps}
	} \subfigure[$t=5s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour99_p5.eps}
	}\\
	\subfigure[$t=10s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour99_p10.eps}
	}\subfigure[$t=50s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour99_p50.eps}
	} \subfigure[$t=100s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour99_p100.eps}
	}\caption{The pictures of wave propagation for Example \ref{ex:4} with $\alpha=1.99.$}\label{fig:15}
	\end{center}
	\end{figure}

%---------------------------------------------------------------------------------------------------------------------------
\begin{figure}[H]
	\begin{center}
	 \subfigure[$t=0s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour2_p0.eps}
	}\subfigure[$t=1s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour2_p1.eps}
	} \subfigure[$t=5s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour2_p5.eps}
	}\\
	\subfigure[$t=10s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour2_p10.eps}
	}\subfigure[$t=50s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour2_p50.eps}
	} \subfigure[$t=100s$]{ \centering
	\includegraphics[width=0.3\textwidth]{./figure/exp2_contour2_p100.eps}
	}\caption{The pictures of wave propagation for Example \ref{ex:4} with $\alpha=2.$}\label{fig:16}
	\end{center}
	\end{figure}



%% The Appendices part is started with the command \appendix;
%% appendix sections are then done as normal sections
%% \appendix

%% \section{}
%% \label{}

%% If you have bibdatabase file and want bibtex to generate the
%% bibitems, please use
%%
% plain,����ĸ��˳������,�Ƚϴ���Ϊ���ߡ���Ⱥͱ���.
% unsrt,��ʽͬplain,ֻ�ǰ������õ��Ⱥ�����.
% alpha,������������ĸ+��ݺ���λ�����,����ĸ˳������.
% abbrv,����plain,���·�ȫƴ��Ϊ��д,���Խ���.
% ieeetr,���ʵ������ӹ���ʦЭ���ڿ���ʽ.
% acm,���������ѧ���ڿ���ʽ.
% siam,������ҵ��Ӧ����ѧѧ���ڿ���ʽ.
% apalike,��������ѧѧ���ڿ���ʽ.
% abbrv��acm��alpha��apalike��ieeetr��plain��unsrt��siam

% \bibliographystyle{elsarticle-num}
% \bibliography{/Users/dasha/Zotero/BetterBibTeX/mylibrary.bib}

%% else use the following coding to input the bibitems directly in the
%% TeX file.

\section*{References}
\begin{thebibliography}{10}
%	\expandafter\ifx\csname url\endcsname\relax
%	  \def\url#1{\texttt{#1}}\fi
%	\expandafter\ifx\csname urlprefix\endcsname\relax\def\urlprefix{URL }\fi
%	\expandafter\ifx\csname href\endcsname\relax
%	  \def\href#1#2{#2} \def\path#1{#1}\fi
	
	\bibitem{caffarelliExtensionProblemRelated2007}
	L.~Caffarelli, L.~Silvestre, An Extension Problem Related to the Fractional Laplacian, Comm Partial
	  Differential Equations 32~(8) (2007) 1245--1260.
	
	\bibitem{yangNumericalMethodsFractional2010}
	Q.~Yang, F.~Liu, I.~Turner,  Numerical  methods for fractional partial differential equations with Riesz space
	  fractional derivatives, Appl Math Model 34~(1) (2010) 200--218.
	
	\bibitem{demengelFunctionalSpacesTheory2012}
	F.~Demengel, G.~Demengel, Functional Spaces for the Theory of Elliptic Partial Differential
	  Equations, Universitext, Springer, London, 2012.
	
	\bibitem{zhangConservativeNumericalScheme2003}
	L.~Zhang, Q.~Chang, A conservative numerical scheme for a class of nonlinear Schr\"odinger
	  equation with wave operator, Appl Math Comput 145~(2) (2003) 603--612.
	
	  \bibitem{baoUniformErrorEstimates2012}
	  W.~Bao, Y.~Cai, Error Estimates of Finite Difference Methods for the Nonlinear
		Schr\"odinger Equation with Wave Operator, SIAM J. Numer. Anal. 50(2) (2012) 492-521.

	\bibitem{chengSeveralConservativeCompact2018}
	X.~Cheng, F.~Wu, Several conservative compact schemes for a class of nonlinear Schr\"odinger
	  equations with wave operator, Bound Value Probl 2018~(1) (2018) 40.
	
	\bibitem{brugnanoClassEnergyconservingHamiltonian2018}
	L.~Brugnano, C.~Zhang, D.~Li, A class of energy-conserving Hamiltonian boundary value methods for nonlinear
	  Schr\"odinger equation with wave operator, Commun Nonlinear Sci Numer Simul 60 (2018) 33--49.
	
	\bibitem{tsutsumiNonrelativisticApproximationNonlinear1984}
	M.~Tsutsumi, Nonrelativistic  approximation of nonlinear Klein-Gordon equations in two space
	  dimensions, Nonlinear Analysis: Theory, Methods \& Applications 8~(6) (1984) 637--643.
	
	\bibitem{machiharaNonrelativisticLimitEnergy2002}
	S.~Machihara, K.~Nakanishi, T.~Ozawa, Nonrelativistic limit in the energy space for nonlinear Klein-Gordon equations, Math Ann
	  322~(3) (2002) 603--621.
	
	\bibitem{colinSemidiscretizationTimeNonlinear1998}
	T.~Colin, P.~Fabrie, Semidiscretization in time for nonlinear Schr\"odinger-waves equations, Discrete Contin
	  Dynam Systems 4~(4) (Tue Jun 30 20:00:00 EDT 1998) 671--690.
	
	\bibitem{baoComparisonsSineGordonPerturbed2010}
	W.~Bao, X.~Dong, J.~Xin, Comparisons between sine-Gordon and perturbed nonlinear Schr\"odinger equations
	  for modeling light bullets beyond critical collapse, Phys D: Nonlinear Phenom 239~(13) (2010) 1120--1134.
	
	\bibitem{xinModelingLightBullets2000}
	J.~Xin, Modeling light bullets with the two-dimensional sine-Gordon equation, Phys D: Nonlinear Phenom 135~(3-4) (2000) 345--368.
	
	\bibitem{laskinFractionalQuantumMechanics2000}
	N.~Laskin, Fractional quantum mechanics, Phys Rev E 62~(3) (2000) 3135--3145.
	
	\bibitem{laskinFractionalSchrodingerEquation2002}
	N.~Laskin, Fractional Schrodinger equation, Phys. Rev. E 66~(5) (2002) 056108.
	
	\bibitem{liFiniteDifferenceCalculus1995}
	S.~Li, L.~Vu-Quoc, Finite Difference Calculus Invariant Structure of a Class of Algorithms for the Nonlinear Klein-Gordon Equation, 
SIAM J Numer Anal 32~(6) (1995) 1839--1875.
	
	\bibitem{wangCrankNicolsonDifference2013}
	D.~Wang, A.~Xiao, W.~Yang, Crank-Nicolson difference scheme for the coupled nonlinear Schr\"odinger equations with
	  the Riesz space fractional derivative, J Comput Phys 242 (2013) 670--681.
	
	\bibitem{wangLinearlyImplicitConservative2014}
	D.~Wang, A.~Xiao, W.~Yang, A linearly implicit conservative difference scheme for the space fractional
	  coupled nonlinear Schr\"odinger equations, J Comput Phys 272 (2014) 644--655.
	
	\bibitem{ranConservativeDifferenceScheme2016}
	M.~Ran, C.~Zhang, A conservative difference scheme for solving the strongly coupled nonlinear
	  fractional Schr\"odinger equations, Commun Nonlinear Sci Numer Simul 41 (2016) 64--83.
	
	\bibitem{wangEnergyConservativeDifference2015}
	P.~Wang, C.~Huang, An energy conservative difference scheme for the nonlinear fractional
	  Schr\"odinger equations, J Comput Phys 293 (2015) 238--251.
	
	\bibitem{wangConservativeLinearizedDifference2015}
	P.~Wang, C.~Huang, A conservative linearized difference scheme for the nonlinear fractional
	  Schr\"odinger equation, Numer Algorithms 69~(3) (2015) 625--641.
	
	\bibitem{wangSplitstepSpectralGalerkin2019}
	Y.~Wang, L.~Mei, Q.~Li, L.~Bu, Split-step spectral Galerkin method for the two-dimensional nonlinear
	  space-fractional Schr\"odinger equation, Appl Numer Math 136 (2019) 257--278.
	
	\bibitem{ranLinearlyImplicitConservative2016}
	M.~Ran, C.~Zhang, A  linearly implicit conservative scheme for the fractional nonlinear
	  Schr\"odinger equation with wave operator, Int J Comput Math 93~(7) (2016) 1103--1118.
	
	\bibitem{liFastEnergyConserving2018}
	M.~Li, Y.-L. Zhao, A fast energy conserving finite element method for the nonlinear fractional
	  Schr\"odinger equation with wave operator, Appl Math Comput 338 (2018) 758--773.
	
	\bibitem{chengConvergenceEnergyconservingScheme2022}
	X.~Cheng, H.~Qin, J.~Zhang,  Convergence of an energy-conserving scheme for nonlinear space fractional
	  Schr\"odinger equations with wave operator, J Comput Appl Math 400 (2022) 113762.

	\bibitem{huEfficientEnergyPreserving2022}
	D.~Hu, W.~Cai, X.-M. Gu, Y.~Wang,  Efficient energy preserving Galerkin-Legendre spectral methods for
	  fractional nonlinear Schr\"odinger equation with wave operator, Appl Numer Math 172 (2022) 608--628.

	\bibitem{zhangHighorderStructurepreservingDifference2023}
	X.~Zhang, M.~Ran, Y.~Liu, L.~Zhang, A high-order structure-preserving difference scheme for generalized fractional
	  Schr\"odinger equation with wave operator, Math Comput Simulation 210 (2023) 532--546.

	\bibitem{buddGeometricIntegrationUsing1999}
	C.~Budd, A.~Iserles, R.~I. McLachlan, G.~R.~W. Quispel, N.~Robidoux,
	  Geometric integration using discrete gradients, Philosophical Transactions of the
	  Royal Society of London. Series A: Mathematical, Physical and Engineering
	  Sciences 357~(1754) (1999) 1021--1045.

	\bibitem{quispelNewClassEnergypreserving2008}
	G.~R.~W. Quispel, D.~I. McLaren, A new  class of energy-preserving numerical integration methods, J Phys A: Math
	  Theor 41~(4) (2008) 045206.

	\bibitem{caiPartitionedAveragedVector2018}
	W.~Cai, H.~Li, Y.~Wang, Partitioned averaged vector field methods, J Comput Phys 370 (2018) 25--42.

	\bibitem{wangStructurepreservingNumericalMethods2018}
	P.~Wang, C.~Huang, Structure-preserving  numerical methods for the fractional Schr\"odinger equation, Appl Numer
	  Math 129 (2018) 137--158.

	\bibitem{fuStructurepreservingAlgorithmsTwodimensional2020}
	Y.~Fu, W.~Cai, Y.~Wang, Structure-preserving algorithms for the two-dimensional fractional Klein-Gordon-Schr\"odinger
	  equation, Appl Numer Math 156 (2020) 77--93.

	\bibitem{liCompactFiniteDifference2012}
	X.~Li, L.~Zhang, S.~Wang, A compact finite difference scheme for the nonlinear Schr\"odinger equation
	  with wave operator, Appl Math Comput 219~(6) (2012) 3187--3197.

	\bibitem{wangAnalysisNewConservative2006}
	T.-C. Wang, L.-M. Zhang, Analysis of some new conservative schemes for nonlinear Schr\"odinger equation
	  with wave operator, Appl Math Comput 182~(2) (2006) 1780--1794.

	\end{thebibliography}
	
\end{document}
\endinput
%%
%% End of file `elsarticle-template-num.tex'.
